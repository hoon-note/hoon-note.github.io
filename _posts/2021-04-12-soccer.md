---
layout: single
title: 'Python ML 연습문제(축구 데이터)'
---

#  분석으로 축구경기 예측하기

----------


​    

## 데이터 소개

    - 다음 1개의 sqlite 데이터베이스를 사용합니다.
    database.sqlite
    
    - 데이터 베이스 내 총 7개의 Table을 사용합니다.
    Country: 국가 정보
    League: 리그 정보
    Match: 경기 정보 (주 데이터셋)
    Player: 플레이어 정보
    Player_Attributes: 플레이어의 특성
    Team: 팀 정보
    Team_Attributes: 팀의 특성

- 데이터 출처: https://www.kaggle.com/hugomathien/soccer

---

## Step 1. 데이터셋 준비하기


```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
```

### sqlite3와 Pandas로 sqlite 데이터베이스 읽어들이기



```python
import sqlite3
```


```python
# sqlite3.connect()와 pd.read_sql_query()로 csv파일 읽어들이기
conn =  sqlite3.connect('database.sqlite')                           
df_country =  pd.read_sql_query('SELECT*FROM Country',conn)
df_league =  pd.read_sql_query('SELECT*FROM League',conn)
df_match =  pd.read_sql_query('SELECT*FROM Match',conn)
df_player =  pd.read_sql_query('SELECT*FROM Player',conn)
df_player_att =  pd.read_sql_query('SELECT*FROM Player_Attributes',conn)
df_team =  pd.read_sql_query('SELECT*FROM Team',conn)
df_team_att =  pd.read_sql_query('SELECT*FROM Team_Attributes',conn)
```

## Step 2. EDA 및 데이터 기초 통계 분석


### 각 데이터프레임의 구조 파악하기



```python
df_country.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Belgium</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1729</td>
      <td>England</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4769</td>
      <td>France</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7809</td>
      <td>Germany</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10257</td>
      <td>Italy</td>
    </tr>
  </tbody>
</table>

</div>




```python
df_league.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>country_id</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>Belgium Jupiler League</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1729</td>
      <td>1729</td>
      <td>England Premier League</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4769</td>
      <td>4769</td>
      <td>France Ligue 1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7809</td>
      <td>7809</td>
      <td>Germany 1. Bundesliga</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10257</td>
      <td>10257</td>
      <td>Italy Serie A</td>
    </tr>
  </tbody>
</table>

</div>




```python
df_match.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>country_id</th>
      <th>league_id</th>
      <th>season</th>
      <th>stage</th>
      <th>date</th>
      <th>match_api_id</th>
      <th>home_team_api_id</th>
      <th>away_team_api_id</th>
      <th>home_team_goal</th>
      <th>away_team_goal</th>
      <th>home_player_X1</th>
      <th>home_player_X2</th>
      <th>home_player_X3</th>
      <th>home_player_X4</th>
      <th>home_player_X5</th>
      <th>home_player_X6</th>
      <th>home_player_X7</th>
      <th>home_player_X8</th>
      <th>home_player_X9</th>
      <th>home_player_X10</th>
      <th>home_player_X11</th>
      <th>away_player_X1</th>
      <th>away_player_X2</th>
      <th>away_player_X3</th>
      <th>away_player_X4</th>
      <th>away_player_X5</th>
      <th>away_player_X6</th>
      <th>away_player_X7</th>
      <th>away_player_X8</th>
      <th>away_player_X9</th>
      <th>away_player_X10</th>
      <th>away_player_X11</th>
      <th>home_player_Y1</th>
      <th>home_player_Y2</th>
      <th>home_player_Y3</th>
      <th>home_player_Y4</th>
      <th>home_player_Y5</th>
      <th>home_player_Y6</th>
      <th>home_player_Y7</th>
      <th>...</th>
      <th>away_player_10</th>
      <th>away_player_11</th>
      <th>goal</th>
      <th>shoton</th>
      <th>shotoff</th>
      <th>foulcommit</th>
      <th>card</th>
      <th>cross</th>
      <th>corner</th>
      <th>possession</th>
      <th>B365H</th>
      <th>B365D</th>
      <th>B365A</th>
      <th>BWH</th>
      <th>BWD</th>
      <th>BWA</th>
      <th>IWH</th>
      <th>IWD</th>
      <th>IWA</th>
      <th>LBH</th>
      <th>LBD</th>
      <th>LBA</th>
      <th>PSH</th>
      <th>PSD</th>
      <th>PSA</th>
      <th>WHH</th>
      <th>WHD</th>
      <th>WHA</th>
      <th>SJH</th>
      <th>SJD</th>
      <th>SJA</th>
      <th>VCH</th>
      <th>VCD</th>
      <th>VCA</th>
      <th>GBH</th>
      <th>GBD</th>
      <th>GBA</th>
      <th>BSH</th>
      <th>BSD</th>
      <th>BSA</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-17 00:00:00</td>
      <td>492473</td>
      <td>9987</td>
      <td>9993</td>
      <td>1</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>1.73</td>
      <td>3.40</td>
      <td>5.00</td>
      <td>1.75</td>
      <td>3.35</td>
      <td>4.20</td>
      <td>1.85</td>
      <td>3.2</td>
      <td>3.5</td>
      <td>1.80</td>
      <td>3.3</td>
      <td>3.75</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.70</td>
      <td>3.30</td>
      <td>4.33</td>
      <td>1.90</td>
      <td>3.3</td>
      <td>4.00</td>
      <td>1.65</td>
      <td>3.40</td>
      <td>4.50</td>
      <td>1.78</td>
      <td>3.25</td>
      <td>4.00</td>
      <td>1.73</td>
      <td>3.40</td>
      <td>4.20</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-16 00:00:00</td>
      <td>492474</td>
      <td>10000</td>
      <td>9994</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>1.95</td>
      <td>3.20</td>
      <td>3.60</td>
      <td>1.80</td>
      <td>3.30</td>
      <td>3.95</td>
      <td>1.90</td>
      <td>3.2</td>
      <td>3.5</td>
      <td>1.90</td>
      <td>3.2</td>
      <td>3.50</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.83</td>
      <td>3.30</td>
      <td>3.60</td>
      <td>1.95</td>
      <td>3.3</td>
      <td>3.80</td>
      <td>2.00</td>
      <td>3.25</td>
      <td>3.25</td>
      <td>1.85</td>
      <td>3.25</td>
      <td>3.75</td>
      <td>1.91</td>
      <td>3.25</td>
      <td>3.60</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-16 00:00:00</td>
      <td>492475</td>
      <td>9984</td>
      <td>8635</td>
      <td>0</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>2.38</td>
      <td>3.30</td>
      <td>2.75</td>
      <td>2.40</td>
      <td>3.30</td>
      <td>2.55</td>
      <td>2.60</td>
      <td>3.1</td>
      <td>2.3</td>
      <td>2.50</td>
      <td>3.2</td>
      <td>2.50</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.50</td>
      <td>3.25</td>
      <td>2.40</td>
      <td>2.63</td>
      <td>3.3</td>
      <td>2.50</td>
      <td>2.35</td>
      <td>3.25</td>
      <td>2.65</td>
      <td>2.50</td>
      <td>3.20</td>
      <td>2.50</td>
      <td>2.30</td>
      <td>3.20</td>
      <td>2.75</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-17 00:00:00</td>
      <td>492476</td>
      <td>9991</td>
      <td>9998</td>
      <td>5</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>1.44</td>
      <td>3.75</td>
      <td>7.50</td>
      <td>1.40</td>
      <td>4.00</td>
      <td>6.80</td>
      <td>1.40</td>
      <td>3.9</td>
      <td>6.0</td>
      <td>1.44</td>
      <td>3.6</td>
      <td>6.50</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.44</td>
      <td>3.75</td>
      <td>6.00</td>
      <td>1.44</td>
      <td>4.0</td>
      <td>7.50</td>
      <td>1.45</td>
      <td>3.75</td>
      <td>6.50</td>
      <td>1.50</td>
      <td>3.75</td>
      <td>5.50</td>
      <td>1.44</td>
      <td>3.75</td>
      <td>6.50</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-16 00:00:00</td>
      <td>492477</td>
      <td>7947</td>
      <td>9985</td>
      <td>1</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>5.00</td>
      <td>3.50</td>
      <td>1.65</td>
      <td>5.00</td>
      <td>3.50</td>
      <td>1.60</td>
      <td>4.00</td>
      <td>3.3</td>
      <td>1.7</td>
      <td>4.00</td>
      <td>3.4</td>
      <td>1.72</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.20</td>
      <td>3.40</td>
      <td>1.70</td>
      <td>4.50</td>
      <td>3.5</td>
      <td>1.73</td>
      <td>4.50</td>
      <td>3.40</td>
      <td>1.65</td>
      <td>4.50</td>
      <td>3.50</td>
      <td>1.65</td>
      <td>4.75</td>
      <td>3.30</td>
      <td>1.67</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 115 columns</p>

</div>




```python
df_player.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>player_api_id</th>
      <th>player_name</th>
      <th>player_fifa_api_id</th>
      <th>birthday</th>
      <th>height</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>505942</td>
      <td>Aaron Appindangoye</td>
      <td>218353</td>
      <td>1992-02-29 00:00:00</td>
      <td>182.88</td>
      <td>187</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>155782</td>
      <td>Aaron Cresswell</td>
      <td>189615</td>
      <td>1989-12-15 00:00:00</td>
      <td>170.18</td>
      <td>146</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>162549</td>
      <td>Aaron Doran</td>
      <td>186170</td>
      <td>1991-05-13 00:00:00</td>
      <td>170.18</td>
      <td>163</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>30572</td>
      <td>Aaron Galindo</td>
      <td>140161</td>
      <td>1982-05-08 00:00:00</td>
      <td>182.88</td>
      <td>198</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>23780</td>
      <td>Aaron Hughes</td>
      <td>17725</td>
      <td>1979-11-08 00:00:00</td>
      <td>182.88</td>
      <td>154</td>
    </tr>
  </tbody>
</table>

</div>




```python
df_country.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 11 entries, 0 to 10
    Data columns (total 2 columns):
     #   Column  Non-Null Count  Dtype 
    ---  ------  --------------  ----- 
     0   id      11 non-null     int64 
     1   name    11 non-null     object
    dtypes: int64(1), object(1)
    memory usage: 304.0+ bytes



```python
df_league.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 11 entries, 0 to 10
    Data columns (total 3 columns):
     #   Column      Non-Null Count  Dtype 
    ---  ------      --------------  ----- 
     0   id          11 non-null     int64 
     1   country_id  11 non-null     int64 
     2   name        11 non-null     object
    dtypes: int64(2), object(1)
    memory usage: 392.0+ bytes



```python
df_match.loc[df_match['league_id'] == 1729] # 프리미어리그 데이터
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>country_id</th>
      <th>league_id</th>
      <th>season</th>
      <th>stage</th>
      <th>date</th>
      <th>match_api_id</th>
      <th>home_team_api_id</th>
      <th>away_team_api_id</th>
      <th>home_team_goal</th>
      <th>away_team_goal</th>
      <th>home_player_X1</th>
      <th>home_player_X2</th>
      <th>home_player_X3</th>
      <th>home_player_X4</th>
      <th>home_player_X5</th>
      <th>home_player_X6</th>
      <th>home_player_X7</th>
      <th>home_player_X8</th>
      <th>home_player_X9</th>
      <th>home_player_X10</th>
      <th>home_player_X11</th>
      <th>away_player_X1</th>
      <th>away_player_X2</th>
      <th>away_player_X3</th>
      <th>away_player_X4</th>
      <th>away_player_X5</th>
      <th>away_player_X6</th>
      <th>away_player_X7</th>
      <th>away_player_X8</th>
      <th>away_player_X9</th>
      <th>away_player_X10</th>
      <th>away_player_X11</th>
      <th>home_player_Y1</th>
      <th>home_player_Y2</th>
      <th>home_player_Y3</th>
      <th>home_player_Y4</th>
      <th>home_player_Y5</th>
      <th>home_player_Y6</th>
      <th>home_player_Y7</th>
      <th>...</th>
      <th>away_player_10</th>
      <th>away_player_11</th>
      <th>goal</th>
      <th>shoton</th>
      <th>shotoff</th>
      <th>foulcommit</th>
      <th>card</th>
      <th>cross</th>
      <th>corner</th>
      <th>possession</th>
      <th>B365H</th>
      <th>B365D</th>
      <th>B365A</th>
      <th>BWH</th>
      <th>BWD</th>
      <th>BWA</th>
      <th>IWH</th>
      <th>IWD</th>
      <th>IWA</th>
      <th>LBH</th>
      <th>LBD</th>
      <th>LBA</th>
      <th>PSH</th>
      <th>PSD</th>
      <th>PSA</th>
      <th>WHH</th>
      <th>WHD</th>
      <th>WHA</th>
      <th>SJH</th>
      <th>SJD</th>
      <th>SJA</th>
      <th>VCH</th>
      <th>VCD</th>
      <th>VCA</th>
      <th>GBH</th>
      <th>GBD</th>
      <th>GBA</th>
      <th>BSH</th>
      <th>BSD</th>
      <th>BSA</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1728</th>
      <td>1729</td>
      <td>1729</td>
      <td>1729</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-17 00:00:00</td>
      <td>489042</td>
      <td>10260</td>
      <td>10261</td>
      <td>1</td>
      <td>1</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>34574.0</td>
      <td>37799.0</td>
      <td>&lt;goal&gt;&lt;value&gt;&lt;comment&gt;n&lt;/comment&gt;&lt;stats&gt;&lt;goals...</td>
      <td>&lt;shoton&gt;&lt;value&gt;&lt;stats&gt;&lt;blocked&gt;1&lt;/blocked&gt;&lt;/st...</td>
      <td>&lt;shotoff&gt;&lt;value&gt;&lt;stats&gt;&lt;shotoff&gt;1&lt;/shotoff&gt;&lt;/s...</td>
      <td>&lt;foulcommit&gt;&lt;value&gt;&lt;stats&gt;&lt;foulscommitted&gt;1&lt;/f...</td>
      <td>&lt;card&gt;&lt;value&gt;&lt;comment&gt;y&lt;/comment&gt;&lt;stats&gt;&lt;ycard...</td>
      <td>&lt;cross&gt;&lt;value&gt;&lt;stats&gt;&lt;crosses&gt;1&lt;/crosses&gt;&lt;/sta...</td>
      <td>&lt;corner&gt;&lt;value&gt;&lt;stats&gt;&lt;corners&gt;1&lt;/corners&gt;&lt;/st...</td>
      <td>&lt;possession&gt;&lt;value&gt;&lt;comment&gt;56&lt;/comment&gt;&lt;event...</td>
      <td>1.29</td>
      <td>5.5</td>
      <td>11.00</td>
      <td>1.30</td>
      <td>4.75</td>
      <td>8.25</td>
      <td>1.30</td>
      <td>4.40</td>
      <td>8.50</td>
      <td>1.25</td>
      <td>4.50</td>
      <td>10.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.25</td>
      <td>4.50</td>
      <td>10.00</td>
      <td>1.25</td>
      <td>5.00</td>
      <td>10.00</td>
      <td>1.28</td>
      <td>5.5</td>
      <td>12.00</td>
      <td>1.30</td>
      <td>4.75</td>
      <td>10.0</td>
      <td>1.29</td>
      <td>4.50</td>
      <td>11.00</td>
    </tr>
    <tr>
      <th>1729</th>
      <td>1730</td>
      <td>1729</td>
      <td>1729</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-16 00:00:00</td>
      <td>489043</td>
      <td>9825</td>
      <td>8659</td>
      <td>1</td>
      <td>0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>25922.0</td>
      <td>27267.0</td>
      <td>&lt;goal&gt;&lt;value&gt;&lt;comment&gt;n&lt;/comment&gt;&lt;stats&gt;&lt;goals...</td>
      <td>&lt;shoton&gt;&lt;value&gt;&lt;stats&gt;&lt;blocked&gt;1&lt;/blocked&gt;&lt;/st...</td>
      <td>&lt;shotoff&gt;&lt;value&gt;&lt;stats&gt;&lt;shotoff&gt;1&lt;/shotoff&gt;&lt;/s...</td>
      <td>&lt;foulcommit&gt;&lt;value&gt;&lt;stats&gt;&lt;foulscommitted&gt;1&lt;/f...</td>
      <td>&lt;card /&gt;</td>
      <td>&lt;cross&gt;&lt;value&gt;&lt;stats&gt;&lt;crosses&gt;1&lt;/crosses&gt;&lt;/sta...</td>
      <td>&lt;corner&gt;&lt;value&gt;&lt;stats&gt;&lt;corners&gt;1&lt;/corners&gt;&lt;/st...</td>
      <td>&lt;possession&gt;&lt;value&gt;&lt;comment&gt;65&lt;/comment&gt;&lt;event...</td>
      <td>1.20</td>
      <td>6.5</td>
      <td>15.00</td>
      <td>1.22</td>
      <td>5.50</td>
      <td>10.00</td>
      <td>1.20</td>
      <td>5.20</td>
      <td>11.00</td>
      <td>1.20</td>
      <td>5.00</td>
      <td>11.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.17</td>
      <td>5.50</td>
      <td>12.00</td>
      <td>1.20</td>
      <td>5.50</td>
      <td>12.00</td>
      <td>1.25</td>
      <td>6.0</td>
      <td>13.00</td>
      <td>1.22</td>
      <td>5.50</td>
      <td>13.0</td>
      <td>1.22</td>
      <td>5.00</td>
      <td>13.00</td>
    </tr>
    <tr>
      <th>1730</th>
      <td>1731</td>
      <td>1729</td>
      <td>1729</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-16 00:00:00</td>
      <td>489044</td>
      <td>8472</td>
      <td>8650</td>
      <td>0</td>
      <td>1</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>24635.0</td>
      <td>30853.0</td>
      <td>&lt;goal&gt;&lt;value&gt;&lt;comment&gt;n&lt;/comment&gt;&lt;stats&gt;&lt;goals...</td>
      <td>&lt;shoton&gt;&lt;value&gt;&lt;stats&gt;&lt;blocked&gt;1&lt;/blocked&gt;&lt;/st...</td>
      <td>&lt;shotoff&gt;&lt;value&gt;&lt;stats&gt;&lt;shotoff&gt;1&lt;/shotoff&gt;&lt;/s...</td>
      <td>&lt;foulcommit&gt;&lt;value&gt;&lt;stats&gt;&lt;foulscommitted&gt;1&lt;/f...</td>
      <td>&lt;card&gt;&lt;value&gt;&lt;comment&gt;y&lt;/comment&gt;&lt;stats&gt;&lt;ycard...</td>
      <td>&lt;cross&gt;&lt;value&gt;&lt;stats&gt;&lt;crosses&gt;1&lt;/crosses&gt;&lt;/sta...</td>
      <td>&lt;corner&gt;&lt;value&gt;&lt;stats&gt;&lt;corners&gt;1&lt;/corners&gt;&lt;/st...</td>
      <td>&lt;possession&gt;&lt;value&gt;&lt;comment&gt;45&lt;/comment&gt;&lt;event...</td>
      <td>5.50</td>
      <td>3.6</td>
      <td>1.67</td>
      <td>5.00</td>
      <td>3.35</td>
      <td>1.67</td>
      <td>4.50</td>
      <td>3.50</td>
      <td>1.65</td>
      <td>4.50</td>
      <td>3.30</td>
      <td>1.67</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.50</td>
      <td>3.30</td>
      <td>1.57</td>
      <td>4.33</td>
      <td>3.40</td>
      <td>1.73</td>
      <td>5.50</td>
      <td>3.8</td>
      <td>1.65</td>
      <td>5.00</td>
      <td>3.40</td>
      <td>1.7</td>
      <td>4.50</td>
      <td>3.40</td>
      <td>1.73</td>
    </tr>
    <tr>
      <th>1731</th>
      <td>1732</td>
      <td>1729</td>
      <td>1729</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-16 00:00:00</td>
      <td>489045</td>
      <td>8654</td>
      <td>8528</td>
      <td>2</td>
      <td>1</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>127857.0</td>
      <td>34466.0</td>
      <td>&lt;goal&gt;&lt;value&gt;&lt;comment&gt;n&lt;/comment&gt;&lt;stats&gt;&lt;goals...</td>
      <td>&lt;shoton&gt;&lt;value&gt;&lt;stats&gt;&lt;shoton&gt;1&lt;/shoton&gt;&lt;/stat...</td>
      <td>&lt;shotoff&gt;&lt;value&gt;&lt;stats&gt;&lt;shotoff&gt;1&lt;/shotoff&gt;&lt;/s...</td>
      <td>&lt;foulcommit&gt;&lt;value&gt;&lt;stats&gt;&lt;foulscommitted&gt;1&lt;/f...</td>
      <td>&lt;card&gt;&lt;value&gt;&lt;comment&gt;y&lt;/comment&gt;&lt;stats&gt;&lt;ycard...</td>
      <td>&lt;cross&gt;&lt;value&gt;&lt;stats&gt;&lt;crosses&gt;1&lt;/crosses&gt;&lt;/sta...</td>
      <td>&lt;corner&gt;&lt;value&gt;&lt;stats&gt;&lt;corners&gt;1&lt;/corners&gt;&lt;/st...</td>
      <td>&lt;possession&gt;&lt;value&gt;&lt;comment&gt;50&lt;/comment&gt;&lt;event...</td>
      <td>1.91</td>
      <td>3.4</td>
      <td>4.20</td>
      <td>1.90</td>
      <td>3.20</td>
      <td>3.80</td>
      <td>1.80</td>
      <td>3.30</td>
      <td>3.80</td>
      <td>1.80</td>
      <td>3.20</td>
      <td>4.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.83</td>
      <td>3.20</td>
      <td>3.75</td>
      <td>1.91</td>
      <td>3.25</td>
      <td>3.75</td>
      <td>1.90</td>
      <td>3.5</td>
      <td>4.35</td>
      <td>1.91</td>
      <td>3.25</td>
      <td>4.0</td>
      <td>1.91</td>
      <td>3.25</td>
      <td>3.80</td>
    </tr>
    <tr>
      <th>1732</th>
      <td>1733</td>
      <td>1729</td>
      <td>1729</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-17 00:00:00</td>
      <td>489046</td>
      <td>10252</td>
      <td>8456</td>
      <td>4</td>
      <td>2</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>9.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>33633.0</td>
      <td>107216.0</td>
      <td>&lt;goal&gt;&lt;value&gt;&lt;comment&gt;n&lt;/comment&gt;&lt;stats&gt;&lt;goals...</td>
      <td>&lt;shoton&gt;&lt;value&gt;&lt;stats&gt;&lt;blocked&gt;1&lt;/blocked&gt;&lt;/st...</td>
      <td>&lt;shotoff&gt;&lt;value&gt;&lt;stats&gt;&lt;shotoff&gt;1&lt;/shotoff&gt;&lt;/s...</td>
      <td>&lt;foulcommit&gt;&lt;value&gt;&lt;stats&gt;&lt;foulscommitted&gt;1&lt;/f...</td>
      <td>&lt;card&gt;&lt;value&gt;&lt;comment&gt;y&lt;/comment&gt;&lt;stats&gt;&lt;ycard...</td>
      <td>&lt;cross&gt;&lt;value&gt;&lt;stats&gt;&lt;corners&gt;1&lt;/corners&gt;&lt;/sta...</td>
      <td>&lt;corner&gt;&lt;value&gt;&lt;stats&gt;&lt;corners&gt;1&lt;/corners&gt;&lt;/st...</td>
      <td>&lt;possession&gt;&lt;value&gt;&lt;comment&gt;51&lt;/comment&gt;&lt;event...</td>
      <td>1.91</td>
      <td>3.4</td>
      <td>4.33</td>
      <td>1.95</td>
      <td>3.20</td>
      <td>3.60</td>
      <td>2.00</td>
      <td>3.20</td>
      <td>3.30</td>
      <td>1.83</td>
      <td>3.20</td>
      <td>3.75</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.91</td>
      <td>3.20</td>
      <td>3.50</td>
      <td>1.91</td>
      <td>3.25</td>
      <td>3.75</td>
      <td>1.90</td>
      <td>3.5</td>
      <td>4.35</td>
      <td>1.91</td>
      <td>3.25</td>
      <td>4.0</td>
      <td>1.91</td>
      <td>3.30</td>
      <td>3.75</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4763</th>
      <td>4764</td>
      <td>1729</td>
      <td>1729</td>
      <td>2015/2016</td>
      <td>9</td>
      <td>2015-10-17 00:00:00</td>
      <td>1988795</td>
      <td>8466</td>
      <td>8197</td>
      <td>2</td>
      <td>2</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>...</td>
      <td>20694.0</td>
      <td>286119.0</td>
      <td>&lt;goal&gt;&lt;value&gt;&lt;comment&gt;n&lt;/comment&gt;&lt;stats&gt;&lt;goals...</td>
      <td>&lt;shoton&gt;&lt;value&gt;&lt;stats&gt;&lt;shoton&gt;1&lt;/shoton&gt;&lt;/stat...</td>
      <td>&lt;shotoff&gt;&lt;value&gt;&lt;stats&gt;&lt;shotoff&gt;1&lt;/shotoff&gt;&lt;/s...</td>
      <td>&lt;foulcommit&gt;&lt;value&gt;&lt;stats&gt;&lt;foulscommitted&gt;1&lt;/f...</td>
      <td>&lt;card&gt;&lt;value&gt;&lt;comment&gt;y&lt;/comment&gt;&lt;stats&gt;&lt;ycard...</td>
      <td>&lt;cross&gt;&lt;value&gt;&lt;stats&gt;&lt;crosses&gt;1&lt;/crosses&gt;&lt;/sta...</td>
      <td>&lt;corner&gt;&lt;value&gt;&lt;stats&gt;&lt;corners&gt;1&lt;/corners&gt;&lt;/st...</td>
      <td>&lt;possession&gt;&lt;value&gt;&lt;comment&gt;54&lt;/comment&gt;&lt;stats...</td>
      <td>1.75</td>
      <td>4.0</td>
      <td>5.00</td>
      <td>1.75</td>
      <td>3.70</td>
      <td>4.40</td>
      <td>1.80</td>
      <td>3.50</td>
      <td>4.20</td>
      <td>1.75</td>
      <td>3.75</td>
      <td>5.00</td>
      <td>1.76</td>
      <td>3.88</td>
      <td>5.10</td>
      <td>1.80</td>
      <td>3.25</td>
      <td>5.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.75</td>
      <td>3.9</td>
      <td>5.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4764</th>
      <td>4765</td>
      <td>1729</td>
      <td>1729</td>
      <td>2015/2016</td>
      <td>9</td>
      <td>2015-10-19 00:00:00</td>
      <td>1988796</td>
      <td>10003</td>
      <td>10194</td>
      <td>0</td>
      <td>1</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>...</td>
      <td>110148.0</td>
      <td>172321.0</td>
      <td>&lt;goal&gt;&lt;value&gt;&lt;comment&gt;p&lt;/comment&gt;&lt;stats&gt;&lt;penal...</td>
      <td>&lt;shoton&gt;&lt;value&gt;&lt;stats&gt;&lt;shoton&gt;1&lt;/shoton&gt;&lt;/stat...</td>
      <td>&lt;shotoff&gt;&lt;value&gt;&lt;stats&gt;&lt;shotoff&gt;1&lt;/shotoff&gt;&lt;/s...</td>
      <td>&lt;foulcommit&gt;&lt;value&gt;&lt;stats&gt;&lt;foulscommitted&gt;1&lt;/f...</td>
      <td>&lt;card&gt;&lt;value&gt;&lt;comment&gt;y&lt;/comment&gt;&lt;stats&gt;&lt;ycard...</td>
      <td>&lt;cross&gt;&lt;value&gt;&lt;stats&gt;&lt;crosses&gt;1&lt;/crosses&gt;&lt;/sta...</td>
      <td>&lt;corner&gt;&lt;value&gt;&lt;stats&gt;&lt;corners&gt;1&lt;/corners&gt;&lt;/st...</td>
      <td>&lt;possession&gt;&lt;value&gt;&lt;comment&gt;53&lt;/comment&gt;&lt;stats...</td>
      <td>2.05</td>
      <td>3.4</td>
      <td>4.20</td>
      <td>2.05</td>
      <td>3.20</td>
      <td>3.75</td>
      <td>2.00</td>
      <td>3.30</td>
      <td>3.60</td>
      <td>2.05</td>
      <td>3.40</td>
      <td>4.00</td>
      <td>2.08</td>
      <td>3.41</td>
      <td>4.06</td>
      <td>2.05</td>
      <td>3.10</td>
      <td>4.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.05</td>
      <td>3.4</td>
      <td>4.10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4765</th>
      <td>4766</td>
      <td>1729</td>
      <td>1729</td>
      <td>2015/2016</td>
      <td>9</td>
      <td>2015-10-17 00:00:00</td>
      <td>1988797</td>
      <td>8586</td>
      <td>8650</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>...</td>
      <td>37234.0</td>
      <td>426202.0</td>
      <td>&lt;goal /&gt;</td>
      <td>&lt;shoton&gt;&lt;value&gt;&lt;stats&gt;&lt;shoton&gt;1&lt;/shoton&gt;&lt;/stat...</td>
      <td>&lt;shotoff&gt;&lt;value&gt;&lt;stats&gt;&lt;shotoff&gt;1&lt;/shotoff&gt;&lt;/s...</td>
      <td>&lt;foulcommit&gt;&lt;value&gt;&lt;stats&gt;&lt;foulscommitted&gt;1&lt;/f...</td>
      <td>&lt;card&gt;&lt;value&gt;&lt;comment&gt;y&lt;/comment&gt;&lt;stats&gt;&lt;ycard...</td>
      <td>&lt;cross&gt;&lt;value&gt;&lt;stats&gt;&lt;crosses&gt;1&lt;/crosses&gt;&lt;/sta...</td>
      <td>&lt;corner&gt;&lt;value&gt;&lt;stats&gt;&lt;corners&gt;1&lt;/corners&gt;&lt;/st...</td>
      <td>&lt;possession&gt;&lt;value&gt;&lt;comment&gt;45&lt;/comment&gt;&lt;stats...</td>
      <td>2.50</td>
      <td>3.5</td>
      <td>3.00</td>
      <td>2.50</td>
      <td>3.20</td>
      <td>2.95</td>
      <td>2.50</td>
      <td>3.20</td>
      <td>2.75</td>
      <td>2.40</td>
      <td>3.40</td>
      <td>2.88</td>
      <td>2.48</td>
      <td>3.54</td>
      <td>2.99</td>
      <td>2.50</td>
      <td>3.30</td>
      <td>3.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.45</td>
      <td>3.5</td>
      <td>3.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4766</th>
      <td>4767</td>
      <td>1729</td>
      <td>1729</td>
      <td>2015/2016</td>
      <td>9</td>
      <td>2015-10-17 00:00:00</td>
      <td>1988798</td>
      <td>9817</td>
      <td>9825</td>
      <td>0</td>
      <td>3</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>...</td>
      <td>50047.0</td>
      <td>31013.0</td>
      <td>&lt;goal&gt;&lt;value&gt;&lt;comment&gt;n&lt;/comment&gt;&lt;stats&gt;&lt;goals...</td>
      <td>&lt;shoton&gt;&lt;value&gt;&lt;stats&gt;&lt;shoton&gt;1&lt;/shoton&gt;&lt;/stat...</td>
      <td>&lt;shotoff&gt;&lt;value&gt;&lt;stats&gt;&lt;shotoff&gt;1&lt;/shotoff&gt;&lt;/s...</td>
      <td>&lt;foulcommit&gt;&lt;value&gt;&lt;stats&gt;&lt;foulscommitted&gt;1&lt;/f...</td>
      <td>&lt;card&gt;&lt;value&gt;&lt;comment&gt;y&lt;/comment&gt;&lt;stats&gt;&lt;ycard...</td>
      <td>&lt;cross&gt;&lt;value&gt;&lt;stats&gt;&lt;crosses&gt;1&lt;/crosses&gt;&lt;/sta...</td>
      <td>&lt;corner&gt;&lt;value&gt;&lt;stats&gt;&lt;corners&gt;1&lt;/corners&gt;&lt;/st...</td>
      <td>&lt;possession&gt;&lt;value&gt;&lt;comment&gt;39&lt;/comment&gt;&lt;stats...</td>
      <td>6.00</td>
      <td>4.2</td>
      <td>1.62</td>
      <td>5.00</td>
      <td>4.10</td>
      <td>1.60</td>
      <td>5.00</td>
      <td>3.90</td>
      <td>1.60</td>
      <td>6.00</td>
      <td>4.00</td>
      <td>1.62</td>
      <td>6.29</td>
      <td>4.31</td>
      <td>1.59</td>
      <td>6.00</td>
      <td>3.60</td>
      <td>1.62</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.25</td>
      <td>4.2</td>
      <td>1.60</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4767</th>
      <td>4768</td>
      <td>1729</td>
      <td>1729</td>
      <td>2015/2016</td>
      <td>9</td>
      <td>2015-10-17 00:00:00</td>
      <td>1988799</td>
      <td>8659</td>
      <td>8472</td>
      <td>1</td>
      <td>0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>32627.0</td>
      <td>184822.0</td>
      <td>&lt;goal&gt;&lt;value&gt;&lt;comment&gt;n&lt;/comment&gt;&lt;stats&gt;&lt;goals...</td>
      <td>&lt;shoton&gt;&lt;value&gt;&lt;stats&gt;&lt;blocked&gt;1&lt;/blocked&gt;&lt;/st...</td>
      <td>&lt;shotoff&gt;&lt;value&gt;&lt;stats&gt;&lt;shotoff&gt;1&lt;/shotoff&gt;&lt;/s...</td>
      <td>&lt;foulcommit&gt;&lt;value&gt;&lt;stats&gt;&lt;foulscommitted&gt;1&lt;/f...</td>
      <td>&lt;card&gt;&lt;value&gt;&lt;comment&gt;y&lt;/comment&gt;&lt;stats&gt;&lt;ycard...</td>
      <td>&lt;cross&gt;&lt;value&gt;&lt;stats&gt;&lt;crosses&gt;1&lt;/crosses&gt;&lt;/sta...</td>
      <td>&lt;corner&gt;&lt;value&gt;&lt;stats&gt;&lt;corners&gt;1&lt;/corners&gt;&lt;/st...</td>
      <td>&lt;possession&gt;&lt;value&gt;&lt;comment&gt;50&lt;/comment&gt;&lt;stats...</td>
      <td>2.05</td>
      <td>3.4</td>
      <td>4.20</td>
      <td>2.05</td>
      <td>3.25</td>
      <td>3.60</td>
      <td>1.85</td>
      <td>3.45</td>
      <td>4.00</td>
      <td>2.05</td>
      <td>3.25</td>
      <td>4.20</td>
      <td>2.08</td>
      <td>3.42</td>
      <td>4.07</td>
      <td>2.10</td>
      <td>3.00</td>
      <td>4.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.05</td>
      <td>3.3</td>
      <td>4.20</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>3040 rows × 115 columns</p>

</div>




```python
df_match.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>country_id</th>
      <th>league_id</th>
      <th>season</th>
      <th>stage</th>
      <th>date</th>
      <th>match_api_id</th>
      <th>home_team_api_id</th>
      <th>away_team_api_id</th>
      <th>home_team_goal</th>
      <th>away_team_goal</th>
      <th>home_player_X1</th>
      <th>home_player_X2</th>
      <th>home_player_X3</th>
      <th>home_player_X4</th>
      <th>home_player_X5</th>
      <th>home_player_X6</th>
      <th>home_player_X7</th>
      <th>home_player_X8</th>
      <th>home_player_X9</th>
      <th>home_player_X10</th>
      <th>home_player_X11</th>
      <th>away_player_X1</th>
      <th>away_player_X2</th>
      <th>away_player_X3</th>
      <th>away_player_X4</th>
      <th>away_player_X5</th>
      <th>away_player_X6</th>
      <th>away_player_X7</th>
      <th>away_player_X8</th>
      <th>away_player_X9</th>
      <th>away_player_X10</th>
      <th>away_player_X11</th>
      <th>home_player_Y1</th>
      <th>home_player_Y2</th>
      <th>home_player_Y3</th>
      <th>home_player_Y4</th>
      <th>home_player_Y5</th>
      <th>home_player_Y6</th>
      <th>home_player_Y7</th>
      <th>...</th>
      <th>away_player_10</th>
      <th>away_player_11</th>
      <th>goal</th>
      <th>shoton</th>
      <th>shotoff</th>
      <th>foulcommit</th>
      <th>card</th>
      <th>cross</th>
      <th>corner</th>
      <th>possession</th>
      <th>B365H</th>
      <th>B365D</th>
      <th>B365A</th>
      <th>BWH</th>
      <th>BWD</th>
      <th>BWA</th>
      <th>IWH</th>
      <th>IWD</th>
      <th>IWA</th>
      <th>LBH</th>
      <th>LBD</th>
      <th>LBA</th>
      <th>PSH</th>
      <th>PSD</th>
      <th>PSA</th>
      <th>WHH</th>
      <th>WHD</th>
      <th>WHA</th>
      <th>SJH</th>
      <th>SJD</th>
      <th>SJA</th>
      <th>VCH</th>
      <th>VCD</th>
      <th>VCA</th>
      <th>GBH</th>
      <th>GBD</th>
      <th>GBA</th>
      <th>BSH</th>
      <th>BSD</th>
      <th>BSA</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-17 00:00:00</td>
      <td>492473</td>
      <td>9987</td>
      <td>9993</td>
      <td>1</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>1.73</td>
      <td>3.40</td>
      <td>5.00</td>
      <td>1.75</td>
      <td>3.35</td>
      <td>4.20</td>
      <td>1.85</td>
      <td>3.2</td>
      <td>3.5</td>
      <td>1.80</td>
      <td>3.3</td>
      <td>3.75</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.70</td>
      <td>3.30</td>
      <td>4.33</td>
      <td>1.90</td>
      <td>3.3</td>
      <td>4.00</td>
      <td>1.65</td>
      <td>3.40</td>
      <td>4.50</td>
      <td>1.78</td>
      <td>3.25</td>
      <td>4.00</td>
      <td>1.73</td>
      <td>3.40</td>
      <td>4.20</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-16 00:00:00</td>
      <td>492474</td>
      <td>10000</td>
      <td>9994</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>1.95</td>
      <td>3.20</td>
      <td>3.60</td>
      <td>1.80</td>
      <td>3.30</td>
      <td>3.95</td>
      <td>1.90</td>
      <td>3.2</td>
      <td>3.5</td>
      <td>1.90</td>
      <td>3.2</td>
      <td>3.50</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.83</td>
      <td>3.30</td>
      <td>3.60</td>
      <td>1.95</td>
      <td>3.3</td>
      <td>3.80</td>
      <td>2.00</td>
      <td>3.25</td>
      <td>3.25</td>
      <td>1.85</td>
      <td>3.25</td>
      <td>3.75</td>
      <td>1.91</td>
      <td>3.25</td>
      <td>3.60</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-16 00:00:00</td>
      <td>492475</td>
      <td>9984</td>
      <td>8635</td>
      <td>0</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>2.38</td>
      <td>3.30</td>
      <td>2.75</td>
      <td>2.40</td>
      <td>3.30</td>
      <td>2.55</td>
      <td>2.60</td>
      <td>3.1</td>
      <td>2.3</td>
      <td>2.50</td>
      <td>3.2</td>
      <td>2.50</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.50</td>
      <td>3.25</td>
      <td>2.40</td>
      <td>2.63</td>
      <td>3.3</td>
      <td>2.50</td>
      <td>2.35</td>
      <td>3.25</td>
      <td>2.65</td>
      <td>2.50</td>
      <td>3.20</td>
      <td>2.50</td>
      <td>2.30</td>
      <td>3.20</td>
      <td>2.75</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-17 00:00:00</td>
      <td>492476</td>
      <td>9991</td>
      <td>9998</td>
      <td>5</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>1.44</td>
      <td>3.75</td>
      <td>7.50</td>
      <td>1.40</td>
      <td>4.00</td>
      <td>6.80</td>
      <td>1.40</td>
      <td>3.9</td>
      <td>6.0</td>
      <td>1.44</td>
      <td>3.6</td>
      <td>6.50</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.44</td>
      <td>3.75</td>
      <td>6.00</td>
      <td>1.44</td>
      <td>4.0</td>
      <td>7.50</td>
      <td>1.45</td>
      <td>3.75</td>
      <td>6.50</td>
      <td>1.50</td>
      <td>3.75</td>
      <td>5.50</td>
      <td>1.44</td>
      <td>3.75</td>
      <td>6.50</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-16 00:00:00</td>
      <td>492477</td>
      <td>7947</td>
      <td>9985</td>
      <td>1</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>5.00</td>
      <td>3.50</td>
      <td>1.65</td>
      <td>5.00</td>
      <td>3.50</td>
      <td>1.60</td>
      <td>4.00</td>
      <td>3.3</td>
      <td>1.7</td>
      <td>4.00</td>
      <td>3.4</td>
      <td>1.72</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.20</td>
      <td>3.40</td>
      <td>1.70</td>
      <td>4.50</td>
      <td>3.5</td>
      <td>1.73</td>
      <td>4.50</td>
      <td>3.40</td>
      <td>1.65</td>
      <td>4.50</td>
      <td>3.50</td>
      <td>1.65</td>
      <td>4.75</td>
      <td>3.30</td>
      <td>1.67</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 115 columns</p>

</div>




```python
df_match['season'].unique()
```




    array(['2008/2009', '2009/2010', '2010/2011', '2011/2012', '2012/2013',
           '2013/2014', '2014/2015', '2015/2016'], dtype=object)




```python
df_match['stage'].unique() # 38라운드 
```




    array([ 1, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,  2, 20, 21, 22, 23, 24,
           25, 26, 27, 28, 29,  3, 30, 31, 32, 33, 34,  4,  5,  6,  7,  8,  9,
           35, 36, 37, 38])




```python
for c, num in zip(df_match.columns,df_match.isna().sum()): # 데이터가 용량이 커서 사용 결측치
  print(c,num)
```

    id 0
    country_id 0
    league_id 0
    season 0
    stage 0
    date 0
    match_api_id 0
    home_team_api_id 0
    away_team_api_id 0
    home_team_goal 0
    away_team_goal 0
    home_player_X1 1821
    home_player_X2 1821
    home_player_X3 1832
    home_player_X4 1832
    home_player_X5 1832
    home_player_X6 1832
    home_player_X7 1832
    home_player_X8 1832
    home_player_X9 1832
    home_player_X10 1832
    home_player_X11 1832
    away_player_X1 1832
    away_player_X2 1832
    away_player_X3 1832
    away_player_X4 1832
    away_player_X5 1832
    away_player_X6 1832
    away_player_X7 1832
    away_player_X8 1832
    away_player_X9 1833
    away_player_X10 1833
    away_player_X11 1839
    home_player_Y1 1821
    home_player_Y2 1821
    home_player_Y3 1832
    home_player_Y4 1832
    home_player_Y5 1832
    home_player_Y6 1832
    home_player_Y7 1832
    home_player_Y8 1832
    home_player_Y9 1832
    home_player_Y10 1832
    home_player_Y11 1832
    away_player_Y1 1832
    away_player_Y2 1832
    away_player_Y3 1832
    away_player_Y4 1832
    away_player_Y5 1832
    away_player_Y6 1832
    away_player_Y7 1832
    away_player_Y8 1832
    away_player_Y9 1833
    away_player_Y10 1833
    away_player_Y11 1839
    home_player_1 1224
    home_player_2 1315
    home_player_3 1281
    home_player_4 1323
    home_player_5 1316
    home_player_6 1325
    home_player_7 1227
    home_player_8 1309
    home_player_9 1273
    home_player_10 1436
    home_player_11 1555
    away_player_1 1234
    away_player_2 1278
    away_player_3 1293
    away_player_4 1321
    away_player_5 1335
    away_player_6 1313
    away_player_7 1235
    away_player_8 1341
    away_player_9 1328
    away_player_10 1441
    away_player_11 1554
    goal 11762
    shoton 11762
    shotoff 11762
    foulcommit 11762
    card 11762
    cross 11762
    corner 11762
    possession 11762
    B365H 3387
    B365D 3387
    B365A 3387
    BWH 3404
    BWD 3404
    BWA 3404
    IWH 3459
    IWD 3459
    IWA 3459
    LBH 3423
    LBD 3423
    LBA 3423
    PSH 14811
    PSD 14811
    PSA 14811
    WHH 3408
    WHD 3408
    WHA 3408
    SJH 8882
    SJD 8882
    SJA 8882
    VCH 3411
    VCD 3411
    VCA 3411
    GBH 11817
    GBD 11817
    GBA 11817
    BSH 11818
    BSD 11818
    BSA 11818



```python
df_match.drop(df_match.columns[-38:],axis=1,inplace=True) # 필요없는 컬럼 삭제
```


```python
df_match.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>country_id</th>
      <th>league_id</th>
      <th>season</th>
      <th>stage</th>
      <th>date</th>
      <th>match_api_id</th>
      <th>home_team_api_id</th>
      <th>away_team_api_id</th>
      <th>home_team_goal</th>
      <th>away_team_goal</th>
      <th>home_player_X1</th>
      <th>home_player_X2</th>
      <th>home_player_X3</th>
      <th>home_player_X4</th>
      <th>home_player_X5</th>
      <th>home_player_X6</th>
      <th>home_player_X7</th>
      <th>home_player_X8</th>
      <th>home_player_X9</th>
      <th>home_player_X10</th>
      <th>home_player_X11</th>
      <th>away_player_X1</th>
      <th>away_player_X2</th>
      <th>away_player_X3</th>
      <th>away_player_X4</th>
      <th>away_player_X5</th>
      <th>away_player_X6</th>
      <th>away_player_X7</th>
      <th>away_player_X8</th>
      <th>away_player_X9</th>
      <th>away_player_X10</th>
      <th>away_player_X11</th>
      <th>home_player_Y1</th>
      <th>home_player_Y2</th>
      <th>home_player_Y3</th>
      <th>home_player_Y4</th>
      <th>home_player_Y5</th>
      <th>home_player_Y6</th>
      <th>home_player_Y7</th>
      <th>home_player_Y8</th>
      <th>home_player_Y9</th>
      <th>home_player_Y10</th>
      <th>home_player_Y11</th>
      <th>away_player_Y1</th>
      <th>away_player_Y2</th>
      <th>away_player_Y3</th>
      <th>away_player_Y4</th>
      <th>away_player_Y5</th>
      <th>away_player_Y6</th>
      <th>away_player_Y7</th>
      <th>away_player_Y8</th>
      <th>away_player_Y9</th>
      <th>away_player_Y10</th>
      <th>away_player_Y11</th>
      <th>home_player_1</th>
      <th>home_player_2</th>
      <th>home_player_3</th>
      <th>home_player_4</th>
      <th>home_player_5</th>
      <th>home_player_6</th>
      <th>home_player_7</th>
      <th>home_player_8</th>
      <th>home_player_9</th>
      <th>home_player_10</th>
      <th>home_player_11</th>
      <th>away_player_1</th>
      <th>away_player_2</th>
      <th>away_player_3</th>
      <th>away_player_4</th>
      <th>away_player_5</th>
      <th>away_player_6</th>
      <th>away_player_7</th>
      <th>away_player_8</th>
      <th>away_player_9</th>
      <th>away_player_10</th>
      <th>away_player_11</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-17 00:00:00</td>
      <td>492473</td>
      <td>9987</td>
      <td>9993</td>
      <td>1</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-16 00:00:00</td>
      <td>492474</td>
      <td>10000</td>
      <td>9994</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-16 00:00:00</td>
      <td>492475</td>
      <td>9984</td>
      <td>8635</td>
      <td>0</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-17 00:00:00</td>
      <td>492476</td>
      <td>9991</td>
      <td>9998</td>
      <td>5</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-16 00:00:00</td>
      <td>492477</td>
      <td>7947</td>
      <td>9985</td>
      <td>1</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>

</div>




```python
df_player.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>player_api_id</th>
      <th>player_name</th>
      <th>player_fifa_api_id</th>
      <th>birthday</th>
      <th>height</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>505942</td>
      <td>Aaron Appindangoye</td>
      <td>218353</td>
      <td>1992-02-29 00:00:00</td>
      <td>182.88</td>
      <td>187</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>155782</td>
      <td>Aaron Cresswell</td>
      <td>189615</td>
      <td>1989-12-15 00:00:00</td>
      <td>170.18</td>
      <td>146</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>162549</td>
      <td>Aaron Doran</td>
      <td>186170</td>
      <td>1991-05-13 00:00:00</td>
      <td>170.18</td>
      <td>163</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>30572</td>
      <td>Aaron Galindo</td>
      <td>140161</td>
      <td>1982-05-08 00:00:00</td>
      <td>182.88</td>
      <td>198</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>23780</td>
      <td>Aaron Hughes</td>
      <td>17725</td>
      <td>1979-11-08 00:00:00</td>
      <td>182.88</td>
      <td>154</td>
    </tr>
  </tbody>
</table>

</div>




```python
df_player_att.head(3)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>player_fifa_api_id</th>
      <th>player_api_id</th>
      <th>date</th>
      <th>overall_rating</th>
      <th>potential</th>
      <th>preferred_foot</th>
      <th>attacking_work_rate</th>
      <th>defensive_work_rate</th>
      <th>crossing</th>
      <th>finishing</th>
      <th>heading_accuracy</th>
      <th>short_passing</th>
      <th>volleys</th>
      <th>dribbling</th>
      <th>curve</th>
      <th>free_kick_accuracy</th>
      <th>long_passing</th>
      <th>ball_control</th>
      <th>acceleration</th>
      <th>sprint_speed</th>
      <th>agility</th>
      <th>reactions</th>
      <th>balance</th>
      <th>shot_power</th>
      <th>jumping</th>
      <th>stamina</th>
      <th>strength</th>
      <th>long_shots</th>
      <th>aggression</th>
      <th>interceptions</th>
      <th>positioning</th>
      <th>vision</th>
      <th>penalties</th>
      <th>marking</th>
      <th>standing_tackle</th>
      <th>sliding_tackle</th>
      <th>gk_diving</th>
      <th>gk_handling</th>
      <th>gk_kicking</th>
      <th>gk_positioning</th>
      <th>gk_reflexes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>218353</td>
      <td>505942</td>
      <td>2016-02-18 00:00:00</td>
      <td>67.0</td>
      <td>71.0</td>
      <td>right</td>
      <td>medium</td>
      <td>medium</td>
      <td>49.0</td>
      <td>44.0</td>
      <td>71.0</td>
      <td>61.0</td>
      <td>44.0</td>
      <td>51.0</td>
      <td>45.0</td>
      <td>39.0</td>
      <td>64.0</td>
      <td>49.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>47.0</td>
      <td>65.0</td>
      <td>55.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>35.0</td>
      <td>71.0</td>
      <td>70.0</td>
      <td>45.0</td>
      <td>54.0</td>
      <td>48.0</td>
      <td>65.0</td>
      <td>69.0</td>
      <td>69.0</td>
      <td>6.0</td>
      <td>11.0</td>
      <td>10.0</td>
      <td>8.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>218353</td>
      <td>505942</td>
      <td>2015-11-19 00:00:00</td>
      <td>67.0</td>
      <td>71.0</td>
      <td>right</td>
      <td>medium</td>
      <td>medium</td>
      <td>49.0</td>
      <td>44.0</td>
      <td>71.0</td>
      <td>61.0</td>
      <td>44.0</td>
      <td>51.0</td>
      <td>45.0</td>
      <td>39.0</td>
      <td>64.0</td>
      <td>49.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>47.0</td>
      <td>65.0</td>
      <td>55.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>35.0</td>
      <td>71.0</td>
      <td>70.0</td>
      <td>45.0</td>
      <td>54.0</td>
      <td>48.0</td>
      <td>65.0</td>
      <td>69.0</td>
      <td>69.0</td>
      <td>6.0</td>
      <td>11.0</td>
      <td>10.0</td>
      <td>8.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>218353</td>
      <td>505942</td>
      <td>2015-09-21 00:00:00</td>
      <td>62.0</td>
      <td>66.0</td>
      <td>right</td>
      <td>medium</td>
      <td>medium</td>
      <td>49.0</td>
      <td>44.0</td>
      <td>71.0</td>
      <td>61.0</td>
      <td>44.0</td>
      <td>51.0</td>
      <td>45.0</td>
      <td>39.0</td>
      <td>64.0</td>
      <td>49.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>47.0</td>
      <td>65.0</td>
      <td>55.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>35.0</td>
      <td>63.0</td>
      <td>41.0</td>
      <td>45.0</td>
      <td>54.0</td>
      <td>48.0</td>
      <td>65.0</td>
      <td>66.0</td>
      <td>69.0</td>
      <td>6.0</td>
      <td>11.0</td>
      <td>10.0</td>
      <td>8.0</td>
      <td>8.0</td>
    </tr>
  </tbody>
</table>

</div>




```python
df_team.head() 
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>team_api_id</th>
      <th>team_fifa_api_id</th>
      <th>team_long_name</th>
      <th>team_short_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>9987</td>
      <td>673.0</td>
      <td>KRC Genk</td>
      <td>GEN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>9993</td>
      <td>675.0</td>
      <td>Beerschot AC</td>
      <td>BAC</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>10000</td>
      <td>15005.0</td>
      <td>SV Zulte-Waregem</td>
      <td>ZUL</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>9994</td>
      <td>2007.0</td>
      <td>Sporting Lokeren</td>
      <td>LOK</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>9984</td>
      <td>1750.0</td>
      <td>KSV Cercle Brugge</td>
      <td>CEB</td>
    </tr>
  </tbody>
</table>

</div>




```python
df_team_att.head(3)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>team_fifa_api_id</th>
      <th>team_api_id</th>
      <th>date</th>
      <th>buildUpPlaySpeed</th>
      <th>buildUpPlaySpeedClass</th>
      <th>buildUpPlayDribbling</th>
      <th>buildUpPlayDribblingClass</th>
      <th>buildUpPlayPassing</th>
      <th>buildUpPlayPassingClass</th>
      <th>buildUpPlayPositioningClass</th>
      <th>chanceCreationPassing</th>
      <th>chanceCreationPassingClass</th>
      <th>chanceCreationCrossing</th>
      <th>chanceCreationCrossingClass</th>
      <th>chanceCreationShooting</th>
      <th>chanceCreationShootingClass</th>
      <th>chanceCreationPositioningClass</th>
      <th>defencePressure</th>
      <th>defencePressureClass</th>
      <th>defenceAggression</th>
      <th>defenceAggressionClass</th>
      <th>defenceTeamWidth</th>
      <th>defenceTeamWidthClass</th>
      <th>defenceDefenderLineClass</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>434</td>
      <td>9930</td>
      <td>2010-02-22 00:00:00</td>
      <td>60</td>
      <td>Balanced</td>
      <td>NaN</td>
      <td>Little</td>
      <td>50</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>60</td>
      <td>Normal</td>
      <td>65</td>
      <td>Normal</td>
      <td>55</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>50</td>
      <td>Medium</td>
      <td>55</td>
      <td>Press</td>
      <td>45</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>434</td>
      <td>9930</td>
      <td>2014-09-19 00:00:00</td>
      <td>52</td>
      <td>Balanced</td>
      <td>48.0</td>
      <td>Normal</td>
      <td>56</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>54</td>
      <td>Normal</td>
      <td>63</td>
      <td>Normal</td>
      <td>64</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>47</td>
      <td>Medium</td>
      <td>44</td>
      <td>Press</td>
      <td>54</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>434</td>
      <td>9930</td>
      <td>2015-09-10 00:00:00</td>
      <td>47</td>
      <td>Balanced</td>
      <td>41.0</td>
      <td>Normal</td>
      <td>54</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>54</td>
      <td>Normal</td>
      <td>63</td>
      <td>Normal</td>
      <td>64</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>47</td>
      <td>Medium</td>
      <td>44</td>
      <td>Press</td>
      <td>54</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
  </tbody>
</table>

</div>



### 데이터프레임간의 관계 파악하기



```python
# unique()로 값을 비교하거나, map()활용하여 Column 관계를 확인하기

df_player_att['player_api_id'].value_counts()
```




    210278    56
    41269     56
    42116     55
    26472     54
    179795    53
              ..
    163254     2
    266280     2
    37366      2
    238766     2
    26568      2
    Name: player_api_id, Length: 11060, dtype: int64




```python
df_match['away_player_1'].dropna().apply(int).map(df_player_att.groupby('player_api_id').mean()['overall_rating'])
```




    144      67.888889
    145      64.952381
    146      68.000000
    147      65.050000
    148      69.428571
               ...    
    25974    55.833333
    25975    63.638889
    25976    69.333333
    25977    60.100000
    25978    73.133333
    Name: away_player_1, Length: 24745, dtype: float64




```python
df_team_att['team_api_id'].value_counts()
```




    8191    6
    8668    6
    8661    6
    8659    6
    8658    6
           ..
    8613    1
    6631    1
    6351    1
    8614    1
    9824    1
    Name: team_api_id, Length: 288, dtype: int64




```python
df_match['home_team_api_id'].map(df_team_att.groupby('team_api_id').mean()['buildUpPlaySpeed']).isna().sum()
```




    178



### 선수 특성 사이의 상관성 파악하기


```python
# DataFrame의 corr() 메소드와 Seaborn의 heatmap() 메소드를 이용하여 Pearson's correlation 시각화하기

fig = plt.figure(figsize=(5,8))
sns.heatmap(df_player_att.drop(['id','player_fifa_api_id','player_api_id'],axis=1).corr()[['overall_rating']],annot=True)
# 오버롤레이팅에대한 주요요소들 확인하기
```




    <matplotlib.axes._subplots.AxesSubplot at 0x7ff25b8fdd30>



![image-center](/assets/images/sc1.png){: .align-center}



### 매치 데이터프레임에 팀 특성 데이터프레임 통합하기



```python
# DataFrame의 map() 메소드를 활용하여 데이터프레임 통합하기
df_team_att.columns
```




    Index(['id', 'team_fifa_api_id', 'team_api_id', 'date', 'buildUpPlaySpeed',
           'buildUpPlaySpeedClass', 'buildUpPlayDribbling',
           'buildUpPlayDribblingClass', 'buildUpPlayPassing',
           'buildUpPlayPassingClass', 'buildUpPlayPositioningClass',
           'chanceCreationPassing', 'chanceCreationPassingClass',
           'chanceCreationCrossing', 'chanceCreationCrossingClass',
           'chanceCreationShooting', 'chanceCreationShootingClass',
           'chanceCreationPositioningClass', 'defencePressure',
           'defencePressureClass', 'defenceAggression', 'defenceAggressionClass',
           'defenceTeamWidth', 'defenceTeamWidthClass',
           'defenceDefenderLineClass'],
          dtype='object')




```python
df_team_att.drop('buildUpPlayDribbling',axis=1,inplace=True) # 결측치 많은 컬럼 삭제
```


```python
def most(x): # 카테고리컬은 함수를 이용하고 수치형은 mean 값 이용
  return x.value_counts().index[0] # 가장 많이 나온 팀의 특성이 나옴 
```


```python
team_map = df_team_att.groupby('team_api_id').aggregate(
    {
       'buildUpPlaySpeed': 'mean',
       'buildUpPlaySpeedClass': most,
       'buildUpPlayDribblingClass': most,
       'buildUpPlayPassing': 'mean',
       'buildUpPlayPassingClass': most,
       'buildUpPlayPositioningClass': most,
       'chanceCreationPassing': 'mean',
       'chanceCreationPassingClass': most,
       'chanceCreationCrossing': 'mean',
       'chanceCreationCrossingClass': most,
       'chanceCreationShooting': 'mean',
       'chanceCreationShootingClass': most,
       'chanceCreationPositioningClass': most,
       'defencePressure': 'mean',
       'defencePressureClass': most,
       'defenceAggression': 'mean',
       'defenceAggressionClass': most,
       'defenceTeamWidth': 'mean',
       'defenceTeamWidthClass': most,
       'defenceDefenderLineClass': most
    }
)
```


```python
team_map
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>buildUpPlaySpeed</th>
      <th>buildUpPlaySpeedClass</th>
      <th>buildUpPlayDribblingClass</th>
      <th>buildUpPlayPassing</th>
      <th>buildUpPlayPassingClass</th>
      <th>buildUpPlayPositioningClass</th>
      <th>chanceCreationPassing</th>
      <th>chanceCreationPassingClass</th>
      <th>chanceCreationCrossing</th>
      <th>chanceCreationCrossingClass</th>
      <th>chanceCreationShooting</th>
      <th>chanceCreationShootingClass</th>
      <th>chanceCreationPositioningClass</th>
      <th>defencePressure</th>
      <th>defencePressureClass</th>
      <th>defenceAggression</th>
      <th>defenceAggressionClass</th>
      <th>defenceTeamWidth</th>
      <th>defenceTeamWidthClass</th>
      <th>defenceDefenderLineClass</th>
    </tr>
    <tr>
      <th>team_api_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1601</th>
      <td>47.333333</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>46.166667</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>55.500000</td>
      <td>Normal</td>
      <td>60.333333</td>
      <td>Normal</td>
      <td>53.500000</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>47.166667</td>
      <td>Medium</td>
      <td>47.333333</td>
      <td>Press</td>
      <td>49.333333</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
    <tr>
      <th>1773</th>
      <td>52.000000</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>50.000000</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>50.000000</td>
      <td>Normal</td>
      <td>53.000000</td>
      <td>Normal</td>
      <td>54.000000</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>43.000000</td>
      <td>Medium</td>
      <td>44.000000</td>
      <td>Press</td>
      <td>50.000000</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
    <tr>
      <th>1957</th>
      <td>47.166667</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>52.666667</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>50.833333</td>
      <td>Normal</td>
      <td>36.333333</td>
      <td>Normal</td>
      <td>67.000000</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>49.333333</td>
      <td>Medium</td>
      <td>56.333333</td>
      <td>Press</td>
      <td>53.666667</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
    <tr>
      <th>2033</th>
      <td>49.000000</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>48.400000</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>51.800000</td>
      <td>Normal</td>
      <td>44.200000</td>
      <td>Normal</td>
      <td>48.200000</td>
      <td>Normal</td>
      <td>Free Form</td>
      <td>42.200000</td>
      <td>Medium</td>
      <td>33.800000</td>
      <td>Contain</td>
      <td>45.400000</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
    <tr>
      <th>2182</th>
      <td>60.333333</td>
      <td>Fast</td>
      <td>Little</td>
      <td>49.000000</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>56.666667</td>
      <td>Normal</td>
      <td>57.333333</td>
      <td>Normal</td>
      <td>68.000000</td>
      <td>Lots</td>
      <td>Organised</td>
      <td>51.666667</td>
      <td>Medium</td>
      <td>48.500000</td>
      <td>Press</td>
      <td>54.500000</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>10281</th>
      <td>52.833333</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>53.666667</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>50.333333</td>
      <td>Normal</td>
      <td>59.166667</td>
      <td>Lots</td>
      <td>50.333333</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>45.500000</td>
      <td>Medium</td>
      <td>51.166667</td>
      <td>Press</td>
      <td>52.666667</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
    <tr>
      <th>108893</th>
      <td>43.166667</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>53.166667</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>46.000000</td>
      <td>Normal</td>
      <td>38.333333</td>
      <td>Normal</td>
      <td>39.500000</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>38.333333</td>
      <td>Medium</td>
      <td>46.000000</td>
      <td>Press</td>
      <td>46.333333</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
    <tr>
      <th>158085</th>
      <td>67.000000</td>
      <td>Fast</td>
      <td>Normal</td>
      <td>39.000000</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>55.000000</td>
      <td>Normal</td>
      <td>59.000000</td>
      <td>Normal</td>
      <td>46.000000</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>36.000000</td>
      <td>Medium</td>
      <td>38.000000</td>
      <td>Press</td>
      <td>37.000000</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
    <tr>
      <th>208931</th>
      <td>56.000000</td>
      <td>Fast</td>
      <td>Normal</td>
      <td>48.000000</td>
      <td>Short</td>
      <td>Organised</td>
      <td>58.500000</td>
      <td>Normal</td>
      <td>38.000000</td>
      <td>Normal</td>
      <td>52.000000</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>35.500000</td>
      <td>Medium</td>
      <td>49.500000</td>
      <td>Press</td>
      <td>43.000000</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
    <tr>
      <th>274581</th>
      <td>50.000000</td>
      <td>Balanced</td>
      <td>Normal</td>
      <td>50.000000</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>50.000000</td>
      <td>Normal</td>
      <td>50.000000</td>
      <td>Normal</td>
      <td>50.000000</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>45.000000</td>
      <td>Medium</td>
      <td>45.000000</td>
      <td>Press</td>
      <td>50.000000</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
  </tbody>
</table>
<p>288 rows × 20 columns</p>

</div>




```python
df = df_match[['home_team_goal', 'away_team_goal']].copy()
```


```python
for team in ['home_', 'away_']:
  team_map.index.name = team + 'team_api_id'
  for col in team_map.columns:
    df[team + col] = df_match[team_map.index.name].map(team_map[col])
```


```python
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>home_team_goal</th>
      <th>away_team_goal</th>
      <th>home_buildUpPlaySpeed</th>
      <th>home_buildUpPlaySpeedClass</th>
      <th>home_buildUpPlayDribblingClass</th>
      <th>home_buildUpPlayPassing</th>
      <th>home_buildUpPlayPassingClass</th>
      <th>home_buildUpPlayPositioningClass</th>
      <th>home_chanceCreationPassing</th>
      <th>home_chanceCreationPassingClass</th>
      <th>home_chanceCreationCrossing</th>
      <th>home_chanceCreationCrossingClass</th>
      <th>home_chanceCreationShooting</th>
      <th>home_chanceCreationShootingClass</th>
      <th>home_chanceCreationPositioningClass</th>
      <th>home_defencePressure</th>
      <th>home_defencePressureClass</th>
      <th>home_defenceAggression</th>
      <th>home_defenceAggressionClass</th>
      <th>home_defenceTeamWidth</th>
      <th>home_defenceTeamWidthClass</th>
      <th>home_defenceDefenderLineClass</th>
      <th>away_buildUpPlaySpeed</th>
      <th>away_buildUpPlaySpeedClass</th>
      <th>away_buildUpPlayDribblingClass</th>
      <th>away_buildUpPlayPassing</th>
      <th>away_buildUpPlayPassingClass</th>
      <th>away_buildUpPlayPositioningClass</th>
      <th>away_chanceCreationPassing</th>
      <th>away_chanceCreationPassingClass</th>
      <th>away_chanceCreationCrossing</th>
      <th>away_chanceCreationCrossingClass</th>
      <th>away_chanceCreationShooting</th>
      <th>away_chanceCreationShootingClass</th>
      <th>away_chanceCreationPositioningClass</th>
      <th>away_defencePressure</th>
      <th>away_defencePressureClass</th>
      <th>away_defenceAggression</th>
      <th>away_defenceAggressionClass</th>
      <th>away_defenceTeamWidth</th>
      <th>away_defenceTeamWidthClass</th>
      <th>away_defenceDefenderLineClass</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>56.333333</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>44.333333</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>55.666667</td>
      <td>Normal</td>
      <td>52.333333</td>
      <td>Normal</td>
      <td>55.833333</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>49.166667</td>
      <td>Medium</td>
      <td>50.666667</td>
      <td>Press</td>
      <td>59.833333</td>
      <td>Normal</td>
      <td>Cover</td>
      <td>46.000000</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>41.500000</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>46.000000</td>
      <td>Normal</td>
      <td>53.500000</td>
      <td>Normal</td>
      <td>53.750000</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>48.250000</td>
      <td>Medium</td>
      <td>49.000000</td>
      <td>Press</td>
      <td>58.750000</td>
      <td>Wide</td>
      <td>Cover</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>55.500000</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>52.666667</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>50.000000</td>
      <td>Normal</td>
      <td>49.333333</td>
      <td>Normal</td>
      <td>41.500000</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>48.666667</td>
      <td>Medium</td>
      <td>56.166667</td>
      <td>Press</td>
      <td>47.833333</td>
      <td>Normal</td>
      <td>Cover</td>
      <td>64.000000</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>53.500000</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>44.000000</td>
      <td>Normal</td>
      <td>47.666667</td>
      <td>Normal</td>
      <td>54.333333</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>48.833333</td>
      <td>Medium</td>
      <td>55.166667</td>
      <td>Press</td>
      <td>55.500000</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>3</td>
      <td>53.666667</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>44.166667</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>59.000000</td>
      <td>Normal</td>
      <td>60.333333</td>
      <td>Normal</td>
      <td>48.000000</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>60.166667</td>
      <td>Medium</td>
      <td>49.666667</td>
      <td>Press</td>
      <td>64.666667</td>
      <td>Normal</td>
      <td>Cover</td>
      <td>51.333333</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>45.166667</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>63.500000</td>
      <td>Risky</td>
      <td>55.000000</td>
      <td>Normal</td>
      <td>51.333333</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>59.666667</td>
      <td>Medium</td>
      <td>47.666667</td>
      <td>Press</td>
      <td>63.833333</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5</td>
      <td>0</td>
      <td>54.166667</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>46.333333</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>44.500000</td>
      <td>Normal</td>
      <td>64.666667</td>
      <td>Normal</td>
      <td>44.166667</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>51.333333</td>
      <td>Medium</td>
      <td>50.000000</td>
      <td>Press</td>
      <td>45.666667</td>
      <td>Normal</td>
      <td>Cover</td>
      <td>51.666667</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>51.666667</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>55.000000</td>
      <td>Normal</td>
      <td>60.666667</td>
      <td>Lots</td>
      <td>46.000000</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>46.000000</td>
      <td>Medium</td>
      <td>45.000000</td>
      <td>Press</td>
      <td>47.000000</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>59.666667</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>60.333333</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>54.666667</td>
      <td>Normal</td>
      <td>58.833333</td>
      <td>Normal</td>
      <td>61.333333</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>51.500000</td>
      <td>Medium</td>
      <td>57.500000</td>
      <td>Press</td>
      <td>56.500000</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
  </tbody>
</table>

</div>




```python
df.dropna(inplace=True)
```


```python
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>home_team_goal</th>
      <th>away_team_goal</th>
      <th>home_buildUpPlaySpeed</th>
      <th>home_buildUpPlaySpeedClass</th>
      <th>home_buildUpPlayDribblingClass</th>
      <th>home_buildUpPlayPassing</th>
      <th>home_buildUpPlayPassingClass</th>
      <th>home_buildUpPlayPositioningClass</th>
      <th>home_chanceCreationPassing</th>
      <th>home_chanceCreationPassingClass</th>
      <th>home_chanceCreationCrossing</th>
      <th>home_chanceCreationCrossingClass</th>
      <th>home_chanceCreationShooting</th>
      <th>home_chanceCreationShootingClass</th>
      <th>home_chanceCreationPositioningClass</th>
      <th>home_defencePressure</th>
      <th>home_defencePressureClass</th>
      <th>home_defenceAggression</th>
      <th>home_defenceAggressionClass</th>
      <th>home_defenceTeamWidth</th>
      <th>home_defenceTeamWidthClass</th>
      <th>home_defenceDefenderLineClass</th>
      <th>away_buildUpPlaySpeed</th>
      <th>away_buildUpPlaySpeedClass</th>
      <th>away_buildUpPlayDribblingClass</th>
      <th>away_buildUpPlayPassing</th>
      <th>away_buildUpPlayPassingClass</th>
      <th>away_buildUpPlayPositioningClass</th>
      <th>away_chanceCreationPassing</th>
      <th>away_chanceCreationPassingClass</th>
      <th>away_chanceCreationCrossing</th>
      <th>away_chanceCreationCrossingClass</th>
      <th>away_chanceCreationShooting</th>
      <th>away_chanceCreationShootingClass</th>
      <th>away_chanceCreationPositioningClass</th>
      <th>away_defencePressure</th>
      <th>away_defencePressureClass</th>
      <th>away_defenceAggression</th>
      <th>away_defenceAggressionClass</th>
      <th>away_defenceTeamWidth</th>
      <th>away_defenceTeamWidthClass</th>
      <th>away_defenceDefenderLineClass</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>56.333333</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>44.333333</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>55.666667</td>
      <td>Normal</td>
      <td>52.333333</td>
      <td>Normal</td>
      <td>55.833333</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>49.166667</td>
      <td>Medium</td>
      <td>50.666667</td>
      <td>Press</td>
      <td>59.833333</td>
      <td>Normal</td>
      <td>Cover</td>
      <td>46.000000</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>41.500000</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>46.000000</td>
      <td>Normal</td>
      <td>53.500000</td>
      <td>Normal</td>
      <td>53.750000</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>48.250000</td>
      <td>Medium</td>
      <td>49.000000</td>
      <td>Press</td>
      <td>58.750000</td>
      <td>Wide</td>
      <td>Cover</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>55.500000</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>52.666667</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>50.000000</td>
      <td>Normal</td>
      <td>49.333333</td>
      <td>Normal</td>
      <td>41.500000</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>48.666667</td>
      <td>Medium</td>
      <td>56.166667</td>
      <td>Press</td>
      <td>47.833333</td>
      <td>Normal</td>
      <td>Cover</td>
      <td>64.000000</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>53.500000</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>44.000000</td>
      <td>Normal</td>
      <td>47.666667</td>
      <td>Normal</td>
      <td>54.333333</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>48.833333</td>
      <td>Medium</td>
      <td>55.166667</td>
      <td>Press</td>
      <td>55.500000</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>3</td>
      <td>53.666667</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>44.166667</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>59.000000</td>
      <td>Normal</td>
      <td>60.333333</td>
      <td>Normal</td>
      <td>48.000000</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>60.166667</td>
      <td>Medium</td>
      <td>49.666667</td>
      <td>Press</td>
      <td>64.666667</td>
      <td>Normal</td>
      <td>Cover</td>
      <td>51.333333</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>45.166667</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>63.500000</td>
      <td>Risky</td>
      <td>55.000000</td>
      <td>Normal</td>
      <td>51.333333</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>59.666667</td>
      <td>Medium</td>
      <td>47.666667</td>
      <td>Press</td>
      <td>63.833333</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5</td>
      <td>0</td>
      <td>54.166667</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>46.333333</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>44.500000</td>
      <td>Normal</td>
      <td>64.666667</td>
      <td>Normal</td>
      <td>44.166667</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>51.333333</td>
      <td>Medium</td>
      <td>50.000000</td>
      <td>Press</td>
      <td>45.666667</td>
      <td>Normal</td>
      <td>Cover</td>
      <td>51.666667</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>51.666667</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>55.000000</td>
      <td>Normal</td>
      <td>60.666667</td>
      <td>Lots</td>
      <td>46.000000</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>46.000000</td>
      <td>Medium</td>
      <td>45.000000</td>
      <td>Press</td>
      <td>47.000000</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1</td>
      <td>1</td>
      <td>56.666667</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>47.333333</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>47.500000</td>
      <td>Normal</td>
      <td>49.833333</td>
      <td>Normal</td>
      <td>50.333333</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>47.666667</td>
      <td>Medium</td>
      <td>58.833333</td>
      <td>Press</td>
      <td>52.000000</td>
      <td>Normal</td>
      <td>Cover</td>
      <td>49.166667</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>46.500000</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>48.833333</td>
      <td>Normal</td>
      <td>55.833333</td>
      <td>Normal</td>
      <td>47.666667</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>53.666667</td>
      <td>Medium</td>
      <td>53.833333</td>
      <td>Press</td>
      <td>54.666667</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
  </tbody>
</table>

</div>



### 홈과 어웨이의 골 수를 승-무-패 범주로 변환하기


```python
# 홈과 어웨이의 골 수를 범주형 데이터로 변환하기 (0: 홈팀 승, 1: 무승부, 2: 어웨이팀 승)

df['matchResult'] = df[['home_team_goal', 'away_team_goal']].aggregate(lambda x: 0 if x[0] > x[1] else 1 if x[0] == x[1] else 2, axis=1)

```


```python
df.drop(['home_team_goal', 'away_team_goal'], axis=1, inplace=True)
```

## Step 3. 데이터 전처리


###  get_dummies를 이용하여 범주형 데이터 전처리하기


```python
col_cats = list(filter(lambda s: s.find('Class') >= 0 , df.columns))
df_cats = pd.get_dummies(df[col_cats],drop_first=True)
df_cats
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>home_buildUpPlaySpeedClass_Fast</th>
      <th>home_buildUpPlaySpeedClass_Slow</th>
      <th>home_buildUpPlayDribblingClass_Lots</th>
      <th>home_buildUpPlayDribblingClass_Normal</th>
      <th>home_buildUpPlayPassingClass_Mixed</th>
      <th>home_buildUpPlayPassingClass_Short</th>
      <th>home_buildUpPlayPositioningClass_Organised</th>
      <th>home_chanceCreationPassingClass_Risky</th>
      <th>home_chanceCreationPassingClass_Safe</th>
      <th>home_chanceCreationCrossingClass_Lots</th>
      <th>home_chanceCreationCrossingClass_Normal</th>
      <th>home_chanceCreationShootingClass_Normal</th>
      <th>home_chanceCreationPositioningClass_Organised</th>
      <th>home_defencePressureClass_High</th>
      <th>home_defencePressureClass_Medium</th>
      <th>home_defenceAggressionClass_Double</th>
      <th>home_defenceAggressionClass_Press</th>
      <th>home_defenceTeamWidthClass_Normal</th>
      <th>home_defenceTeamWidthClass_Wide</th>
      <th>home_defenceDefenderLineClass_Offside Trap</th>
      <th>away_buildUpPlaySpeedClass_Fast</th>
      <th>away_buildUpPlaySpeedClass_Slow</th>
      <th>away_buildUpPlayDribblingClass_Lots</th>
      <th>away_buildUpPlayDribblingClass_Normal</th>
      <th>away_buildUpPlayPassingClass_Mixed</th>
      <th>away_buildUpPlayPassingClass_Short</th>
      <th>away_buildUpPlayPositioningClass_Organised</th>
      <th>away_chanceCreationPassingClass_Risky</th>
      <th>away_chanceCreationPassingClass_Safe</th>
      <th>away_chanceCreationCrossingClass_Lots</th>
      <th>away_chanceCreationCrossingClass_Normal</th>
      <th>away_chanceCreationShootingClass_Normal</th>
      <th>away_chanceCreationPositioningClass_Organised</th>
      <th>away_defencePressureClass_High</th>
      <th>away_defencePressureClass_Medium</th>
      <th>away_defenceAggressionClass_Double</th>
      <th>away_defenceAggressionClass_Press</th>
      <th>away_defenceTeamWidthClass_Normal</th>
      <th>away_defenceTeamWidthClass_Wide</th>
      <th>away_defenceDefenderLineClass_Offside Trap</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>25972</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25974</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25975</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25976</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25978</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>25629 rows × 40 columns</p>

</div>



### StandardScaler를 이용해 수치형 데이터 표준화하기



```python
from sklearn.preprocessing import StandardScaler
```


```python
# StandardScaler를 이용해 수치형 데이터를 표준화하기
# Multicollinearity를 피하기 위해 불필요한 컬럼은 drop한다.

X_num = df.drop(['matchResult'] + col_cats,axis=1)

scaler = StandardScaler()
scaler.fit(X_num)

X_scaled=scaler.transform(X_num)
X_scaled = pd.DataFrame(data =X_scaled,index=X_num.index,columns=X_num.columns)

X_cat = df_cats 
X =  pd.concat([X_scaled,X_cat],axis=1)
y = df['matchResult']
```


```python
X.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>home_buildUpPlaySpeed</th>
      <th>home_buildUpPlayPassing</th>
      <th>home_chanceCreationPassing</th>
      <th>home_chanceCreationCrossing</th>
      <th>home_chanceCreationShooting</th>
      <th>home_defencePressure</th>
      <th>home_defenceAggression</th>
      <th>home_defenceTeamWidth</th>
      <th>away_buildUpPlaySpeed</th>
      <th>away_buildUpPlayPassing</th>
      <th>away_chanceCreationPassing</th>
      <th>away_chanceCreationCrossing</th>
      <th>away_chanceCreationShooting</th>
      <th>away_defencePressure</th>
      <th>away_defenceAggression</th>
      <th>away_defenceTeamWidth</th>
      <th>home_buildUpPlaySpeedClass_Fast</th>
      <th>home_buildUpPlaySpeedClass_Slow</th>
      <th>home_buildUpPlayDribblingClass_Lots</th>
      <th>home_buildUpPlayDribblingClass_Normal</th>
      <th>home_buildUpPlayPassingClass_Mixed</th>
      <th>home_buildUpPlayPassingClass_Short</th>
      <th>home_buildUpPlayPositioningClass_Organised</th>
      <th>home_chanceCreationPassingClass_Risky</th>
      <th>home_chanceCreationPassingClass_Safe</th>
      <th>home_chanceCreationCrossingClass_Lots</th>
      <th>home_chanceCreationCrossingClass_Normal</th>
      <th>home_chanceCreationShootingClass_Normal</th>
      <th>home_chanceCreationPositioningClass_Organised</th>
      <th>home_defencePressureClass_High</th>
      <th>home_defencePressureClass_Medium</th>
      <th>home_defenceAggressionClass_Double</th>
      <th>home_defenceAggressionClass_Press</th>
      <th>home_defenceTeamWidthClass_Normal</th>
      <th>home_defenceTeamWidthClass_Wide</th>
      <th>home_defenceDefenderLineClass_Offside Trap</th>
      <th>away_buildUpPlaySpeedClass_Fast</th>
      <th>away_buildUpPlaySpeedClass_Slow</th>
      <th>away_buildUpPlayDribblingClass_Lots</th>
      <th>away_buildUpPlayDribblingClass_Normal</th>
      <th>away_buildUpPlayPassingClass_Mixed</th>
      <th>away_buildUpPlayPassingClass_Short</th>
      <th>away_buildUpPlayPositioningClass_Organised</th>
      <th>away_chanceCreationPassingClass_Risky</th>
      <th>away_chanceCreationPassingClass_Safe</th>
      <th>away_chanceCreationCrossingClass_Lots</th>
      <th>away_chanceCreationCrossingClass_Normal</th>
      <th>away_chanceCreationShootingClass_Normal</th>
      <th>away_chanceCreationPositioningClass_Organised</th>
      <th>away_defencePressureClass_High</th>
      <th>away_defencePressureClass_Medium</th>
      <th>away_defenceAggressionClass_Double</th>
      <th>away_defenceAggressionClass_Press</th>
      <th>away_defenceTeamWidthClass_Normal</th>
      <th>away_defenceTeamWidthClass_Wide</th>
      <th>away_defenceDefenderLineClass_Offside Trap</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.524473</td>
      <td>-0.491432</td>
      <td>0.513747</td>
      <td>-0.211037</td>
      <td>0.268240</td>
      <td>0.405160</td>
      <td>0.214042</td>
      <td>1.266800</td>
      <td>-0.828060</td>
      <td>-0.882555</td>
      <td>-0.958503</td>
      <td>-0.050280</td>
      <td>-0.069565</td>
      <td>0.269502</td>
      <td>-0.072044</td>
      <td>1.086301</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.415403</td>
      <td>0.658405</td>
      <td>-0.349147</td>
      <td>-0.624041</td>
      <td>-2.056305</td>
      <td>0.331100</td>
      <td>1.158473</td>
      <td>-0.731538</td>
      <td>1.527352</td>
      <td>0.773235</td>
      <td>-1.263055</td>
      <td>-0.853318</td>
      <td>0.025030</td>
      <td>0.355909</td>
      <td>0.986891</td>
      <td>0.545116</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.175451</td>
      <td>-0.514429</td>
      <td>1.021331</td>
      <td>0.890309</td>
      <td>-1.002151</td>
      <td>2.034483</td>
      <td>0.042327</td>
      <td>2.071686</td>
      <td>-0.130160</td>
      <td>-0.376619</td>
      <td>1.706325</td>
      <td>0.156215</td>
      <td>-0.461459</td>
      <td>1.960604</td>
      <td>-0.301003</td>
      <td>1.932770</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.240893</td>
      <td>-0.215471</td>
      <td>-1.186661</td>
      <td>1.486870</td>
      <td>-1.623832</td>
      <td>0.726087</td>
      <td>0.099566</td>
      <td>-1.092349</td>
      <td>-0.086541</td>
      <td>0.520267</td>
      <td>0.411980</td>
      <td>0.936309</td>
      <td>-1.326330</td>
      <td>-0.063780</td>
      <td>-0.758921</td>
      <td>-0.870290</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.568100</td>
      <td>-0.077490</td>
      <td>-0.729835</td>
      <td>-0.555207</td>
      <td>-0.623736</td>
      <td>0.182980</td>
      <td>1.616379</td>
      <td>-0.037670</td>
      <td>-0.413682</td>
      <td>-0.192642</td>
      <td>-0.527055</td>
      <td>0.270935</td>
      <td>-1.056058</td>
      <td>1.071850</td>
      <td>0.757932</td>
      <td>0.406351</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>

</div>




```python
X.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 25629 entries, 0 to 25978
    Data columns (total 56 columns):
     #   Column                                         Non-Null Count  Dtype  
    ---  ------                                         --------------  -----  
     0   home_buildUpPlaySpeed                          25629 non-null  float64
     1   home_buildUpPlayPassing                        25629 non-null  float64
     2   home_chanceCreationPassing                     25629 non-null  float64
     3   home_chanceCreationCrossing                    25629 non-null  float64
     4   home_chanceCreationShooting                    25629 non-null  float64
     5   home_defencePressure                           25629 non-null  float64
     6   home_defenceAggression                         25629 non-null  float64
     7   home_defenceTeamWidth                          25629 non-null  float64
     8   away_buildUpPlaySpeed                          25629 non-null  float64
     9   away_buildUpPlayPassing                        25629 non-null  float64
     10  away_chanceCreationPassing                     25629 non-null  float64
     11  away_chanceCreationCrossing                    25629 non-null  float64
     12  away_chanceCreationShooting                    25629 non-null  float64
     13  away_defencePressure                           25629 non-null  float64
     14  away_defenceAggression                         25629 non-null  float64
     15  away_defenceTeamWidth                          25629 non-null  float64
     16  home_buildUpPlaySpeedClass_Fast                25629 non-null  uint8  
     17  home_buildUpPlaySpeedClass_Slow                25629 non-null  uint8  
     18  home_buildUpPlayDribblingClass_Lots            25629 non-null  uint8  
     19  home_buildUpPlayDribblingClass_Normal          25629 non-null  uint8  
     20  home_buildUpPlayPassingClass_Mixed             25629 non-null  uint8  
     21  home_buildUpPlayPassingClass_Short             25629 non-null  uint8  
     22  home_buildUpPlayPositioningClass_Organised     25629 non-null  uint8  
     23  home_chanceCreationPassingClass_Risky          25629 non-null  uint8  
     24  home_chanceCreationPassingClass_Safe           25629 non-null  uint8  
     25  home_chanceCreationCrossingClass_Lots          25629 non-null  uint8  
     26  home_chanceCreationCrossingClass_Normal        25629 non-null  uint8  
     27  home_chanceCreationShootingClass_Normal        25629 non-null  uint8  
     28  home_chanceCreationPositioningClass_Organised  25629 non-null  uint8  
     29  home_defencePressureClass_High                 25629 non-null  uint8  
     30  home_defencePressureClass_Medium               25629 non-null  uint8  
     31  home_defenceAggressionClass_Double             25629 non-null  uint8  
     32  home_defenceAggressionClass_Press              25629 non-null  uint8  
     33  home_defenceTeamWidthClass_Normal              25629 non-null  uint8  
     34  home_defenceTeamWidthClass_Wide                25629 non-null  uint8  
     35  home_defenceDefenderLineClass_Offside Trap     25629 non-null  uint8  
     36  away_buildUpPlaySpeedClass_Fast                25629 non-null  uint8  
     37  away_buildUpPlaySpeedClass_Slow                25629 non-null  uint8  
     38  away_buildUpPlayDribblingClass_Lots            25629 non-null  uint8  
     39  away_buildUpPlayDribblingClass_Normal          25629 non-null  uint8  
     40  away_buildUpPlayPassingClass_Mixed             25629 non-null  uint8  
     41  away_buildUpPlayPassingClass_Short             25629 non-null  uint8  
     42  away_buildUpPlayPositioningClass_Organised     25629 non-null  uint8  
     43  away_chanceCreationPassingClass_Risky          25629 non-null  uint8  
     44  away_chanceCreationPassingClass_Safe           25629 non-null  uint8  
     45  away_chanceCreationCrossingClass_Lots          25629 non-null  uint8  
     46  away_chanceCreationCrossingClass_Normal        25629 non-null  uint8  
     47  away_chanceCreationShootingClass_Normal        25629 non-null  uint8  
     48  away_chanceCreationPositioningClass_Organised  25629 non-null  uint8  
     49  away_defencePressureClass_High                 25629 non-null  uint8  
     50  away_defencePressureClass_Medium               25629 non-null  uint8  
     51  away_defenceAggressionClass_Double             25629 non-null  uint8  
     52  away_defenceAggressionClass_Press              25629 non-null  uint8  
     53  away_defenceTeamWidthClass_Normal              25629 non-null  uint8  
     54  away_defenceTeamWidthClass_Wide                25629 non-null  uint8  
     55  away_defenceDefenderLineClass_Offside Trap     25629 non-null  uint8  
    dtypes: float64(16), uint8(40)
    memory usage: 4.3 MB


###  학습데이터와 테스트데이터 분리하기



```python
from sklearn.model_selection import train_test_split
```


```python
# train_test_split() 함수로 학습 데이터와 테스트 데이터 분리하기
X_train, X_test, y_train, y_test = train_test_split(X,y ,test_size=0.3,random_state=1)
```


```python
X_train.shape
```




    (17940, 56)



## Step 4. Classification 모델 학습하기


###  Logistic Regression 모델 생성/학습하기



```python
from sklearn.linear_model import LogisticRegression
```


```python
# LogisticRegression 모델 생성/학습
model_lr = LogisticRegression(max_iter=10000)
model_lr.fit(X_train,y_train)
```




    LogisticRegression(C=1.0, class_weight=None, dual=False, fit_intercept=True,
                       intercept_scaling=1, l1_ratio=None, max_iter=10000,
                       multi_class='auto', n_jobs=None, penalty='l2',
                       random_state=None, solver='lbfgs', tol=0.0001, verbose=0,
                       warm_start=False)



###  모델 학습 결과 평가하기



```python
from sklearn.metrics import classification_report
```


```python
# Predict를 수행하고 classification_report() 결과 출력하기
pred = model_lr.predict(X_test)
print(classification_report(pred,y_test)) 
```

                  precision    recall  f1-score   support
    
               0       0.87      0.49      0.63      6178
               1       0.01      0.46      0.01        26
               2       0.29      0.44      0.35      1485
    
        accuracy                           0.48      7689
       macro avg       0.39      0.46      0.33      7689
    weighted avg       0.76      0.48      0.57      7689


​    


```python
print(sum(y_test ==0) / len(y_test)) # 홈팀 승리 확률
print(sum(y_test ==1) / len(y_test)) # 홈팀 패배 확률
print(sum(y_test ==2) / len(y_test)) # 홈팀 무승부 확률
```

    0.4531148393809338
    0.2564702822213552
    0.290414878397711


###  XGBoost 모델 생성/학습하기



```python
from xgboost import XGBClassifier
```


```python
# XGBClassifier 모델 생성/학습
model_xgb = XGBClassifier()
model_xgb.fit(X_train,y_train)


```




    XGBClassifier(base_score=0.5, booster='gbtree', colsample_bylevel=1,
                  colsample_bynode=1, colsample_bytree=1, gamma=0,
                  learning_rate=0.1, max_delta_step=0, max_depth=3,
                  min_child_weight=1, missing=None, n_estimators=100, n_jobs=1,
                  nthread=None, objective='multi:softprob', random_state=0,
                  reg_alpha=0, reg_lambda=1, scale_pos_weight=1, seed=None,
                  silent=None, subsample=1, verbosity=1)



###  모델 학습 결과 평가하기



```python
# Predict를 수행하고 classification_report() 결과 출력하기
pred = model_xgb.predict(X_test)
print(classification_report(y_test,pred))


# 반의 확률로 예측하는 모델
```

                  precision    recall  f1-score   support
    
               0       0.50      0.90      0.65      3484
               1       0.26      0.01      0.02      1972
               2       0.51      0.31      0.39      2233
    
        accuracy                           0.50      7689
       macro avg       0.43      0.41      0.35      7689
    weighted avg       0.44      0.50      0.41      7689


​    

## Step5 모델 학습 결과 심화 분석하기


### Logistic Regression 모델 계수로 상관성 파악하기


```python
# Logistic Regression 모델의 coef_ 속성을 plot하기

fig = plt.figure(figsize=(15,5))
plt.plot(X.columns,model_lr.coef_[0])
plt.xticks(rotation=90)
plt.grid()
plt.show()
# 홈팀 승리의 주요 요소
```

![image-center](/assets/images/sc2.png){: .align-center}




```python
fig = plt.figure(figsize=(15,5))
plt.plot(X.columns,model_lr.coef_[2])
plt.xticks(rotation=90)
plt.grid()
plt.show()
```

![image-center](/assets/images/sc3.png){: .align-center}



###  XGBoost 모델로 특징의 중요도 확인하기


```python
# XGBoost 모델의 feature_importances_ 속성을 plot하기

fig = plt.figure(figsize=(10,15))
plt.barh(X.columns,model_xgb.feature_importances_)
#plt.xticks(rotation=90)
plt.grid()
plt.show()
# 카테고리컬 데이터들이 사용을 많이 함
```

![image-center](/assets/images/sc4.png){: .align-center}



## Step6 모델 성능 개선하기


### 매치 데이터프레임에 선수 특성 데이터프레임 통합하기


```python
df_player_att.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>player_fifa_api_id</th>
      <th>player_api_id</th>
      <th>date</th>
      <th>overall_rating</th>
      <th>potential</th>
      <th>preferred_foot</th>
      <th>attacking_work_rate</th>
      <th>defensive_work_rate</th>
      <th>crossing</th>
      <th>finishing</th>
      <th>heading_accuracy</th>
      <th>short_passing</th>
      <th>volleys</th>
      <th>dribbling</th>
      <th>curve</th>
      <th>free_kick_accuracy</th>
      <th>long_passing</th>
      <th>ball_control</th>
      <th>acceleration</th>
      <th>sprint_speed</th>
      <th>agility</th>
      <th>reactions</th>
      <th>balance</th>
      <th>shot_power</th>
      <th>jumping</th>
      <th>stamina</th>
      <th>strength</th>
      <th>long_shots</th>
      <th>aggression</th>
      <th>interceptions</th>
      <th>positioning</th>
      <th>vision</th>
      <th>penalties</th>
      <th>marking</th>
      <th>standing_tackle</th>
      <th>sliding_tackle</th>
      <th>gk_diving</th>
      <th>gk_handling</th>
      <th>gk_kicking</th>
      <th>gk_positioning</th>
      <th>gk_reflexes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>218353</td>
      <td>505942</td>
      <td>2016-02-18 00:00:00</td>
      <td>67.0</td>
      <td>71.0</td>
      <td>right</td>
      <td>medium</td>
      <td>medium</td>
      <td>49.0</td>
      <td>44.0</td>
      <td>71.0</td>
      <td>61.0</td>
      <td>44.0</td>
      <td>51.0</td>
      <td>45.0</td>
      <td>39.0</td>
      <td>64.0</td>
      <td>49.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>47.0</td>
      <td>65.0</td>
      <td>55.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>35.0</td>
      <td>71.0</td>
      <td>70.0</td>
      <td>45.0</td>
      <td>54.0</td>
      <td>48.0</td>
      <td>65.0</td>
      <td>69.0</td>
      <td>69.0</td>
      <td>6.0</td>
      <td>11.0</td>
      <td>10.0</td>
      <td>8.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>218353</td>
      <td>505942</td>
      <td>2015-11-19 00:00:00</td>
      <td>67.0</td>
      <td>71.0</td>
      <td>right</td>
      <td>medium</td>
      <td>medium</td>
      <td>49.0</td>
      <td>44.0</td>
      <td>71.0</td>
      <td>61.0</td>
      <td>44.0</td>
      <td>51.0</td>
      <td>45.0</td>
      <td>39.0</td>
      <td>64.0</td>
      <td>49.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>47.0</td>
      <td>65.0</td>
      <td>55.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>35.0</td>
      <td>71.0</td>
      <td>70.0</td>
      <td>45.0</td>
      <td>54.0</td>
      <td>48.0</td>
      <td>65.0</td>
      <td>69.0</td>
      <td>69.0</td>
      <td>6.0</td>
      <td>11.0</td>
      <td>10.0</td>
      <td>8.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>218353</td>
      <td>505942</td>
      <td>2015-09-21 00:00:00</td>
      <td>62.0</td>
      <td>66.0</td>
      <td>right</td>
      <td>medium</td>
      <td>medium</td>
      <td>49.0</td>
      <td>44.0</td>
      <td>71.0</td>
      <td>61.0</td>
      <td>44.0</td>
      <td>51.0</td>
      <td>45.0</td>
      <td>39.0</td>
      <td>64.0</td>
      <td>49.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>47.0</td>
      <td>65.0</td>
      <td>55.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>35.0</td>
      <td>63.0</td>
      <td>41.0</td>
      <td>45.0</td>
      <td>54.0</td>
      <td>48.0</td>
      <td>65.0</td>
      <td>66.0</td>
      <td>69.0</td>
      <td>6.0</td>
      <td>11.0</td>
      <td>10.0</td>
      <td>8.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>218353</td>
      <td>505942</td>
      <td>2015-03-20 00:00:00</td>
      <td>61.0</td>
      <td>65.0</td>
      <td>right</td>
      <td>medium</td>
      <td>medium</td>
      <td>48.0</td>
      <td>43.0</td>
      <td>70.0</td>
      <td>60.0</td>
      <td>43.0</td>
      <td>50.0</td>
      <td>44.0</td>
      <td>38.0</td>
      <td>63.0</td>
      <td>48.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>46.0</td>
      <td>65.0</td>
      <td>54.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>34.0</td>
      <td>62.0</td>
      <td>40.0</td>
      <td>44.0</td>
      <td>53.0</td>
      <td>47.0</td>
      <td>62.0</td>
      <td>63.0</td>
      <td>66.0</td>
      <td>5.0</td>
      <td>10.0</td>
      <td>9.0</td>
      <td>7.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>218353</td>
      <td>505942</td>
      <td>2007-02-22 00:00:00</td>
      <td>61.0</td>
      <td>65.0</td>
      <td>right</td>
      <td>medium</td>
      <td>medium</td>
      <td>48.0</td>
      <td>43.0</td>
      <td>70.0</td>
      <td>60.0</td>
      <td>43.0</td>
      <td>50.0</td>
      <td>44.0</td>
      <td>38.0</td>
      <td>63.0</td>
      <td>48.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>46.0</td>
      <td>65.0</td>
      <td>54.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>34.0</td>
      <td>62.0</td>
      <td>40.0</td>
      <td>44.0</td>
      <td>53.0</td>
      <td>47.0</td>
      <td>62.0</td>
      <td>63.0</td>
      <td>66.0</td>
      <td>5.0</td>
      <td>10.0</td>
      <td>9.0</td>
      <td>7.0</td>
      <td>7.0</td>
    </tr>
  </tbody>
</table>

</div>




```python
# 선수 특성 중 유의미한 정보를 매치 데이터프레임에 통합하기

df = df_match[['home_team_goal', 'away_team_goal']].copy()
```


```python
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>home_team_goal</th>
      <th>away_team_goal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>25974</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25975</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>25976</th>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25977</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25978</th>
      <td>4</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
<p>25979 rows × 2 columns</p>

</div>




```python
df['matchResult'] = df[['home_team_goal', 'away_team_goal']].aggregate(lambda x: 0 if x[0] > x[1] else 1 if x[0] == x[1] else 2, axis=1)
df.drop(['home_team_goal', 'away_team_goal'], axis=1, inplace=True)
```


```python
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>matchResult</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>25974</th>
      <td>0</td>
    </tr>
    <tr>
      <th>25975</th>
      <td>2</td>
    </tr>
    <tr>
      <th>25976</th>
      <td>0</td>
    </tr>
    <tr>
      <th>25977</th>
      <td>1</td>
    </tr>
    <tr>
      <th>25978</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>25979 rows × 1 columns</p>

</div>




```python
for team in ['home_', 'away_']:
  team_map.index.name = team + 'team_api_id'
  for col in team_map.columns:
    df[team + col] = df_match[team_map.index.name].map(team_map[col])
    
```


```python
player_map = df_player_att.groupby('player_api_id').mean()['overall_rating']
player_map
```




    player_api_id
    2625      60.142857
    2752      69.380952
    2768      69.285714
    2770      71.133333
    2790      70.200000
                ...    
    744907    51.909091
    746419    59.000000
    748432    58.000000
    750435    56.444444
    750584    58.000000
    Name: overall_rating, Length: 11060, dtype: float64




```python
for col in (s + str(idx) for s in ['home_player_', 'away_player_'] for idx in range(1, 12)):
  df[col + '_rating']= df_match[col].map(player_map)
```


```python
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>matchResult</th>
      <th>home_buildUpPlaySpeed</th>
      <th>home_buildUpPlaySpeedClass</th>
      <th>home_buildUpPlayDribblingClass</th>
      <th>home_buildUpPlayPassing</th>
      <th>home_buildUpPlayPassingClass</th>
      <th>home_buildUpPlayPositioningClass</th>
      <th>home_chanceCreationPassing</th>
      <th>home_chanceCreationPassingClass</th>
      <th>home_chanceCreationCrossing</th>
      <th>home_chanceCreationCrossingClass</th>
      <th>home_chanceCreationShooting</th>
      <th>home_chanceCreationShootingClass</th>
      <th>home_chanceCreationPositioningClass</th>
      <th>home_defencePressure</th>
      <th>home_defencePressureClass</th>
      <th>home_defenceAggression</th>
      <th>home_defenceAggressionClass</th>
      <th>home_defenceTeamWidth</th>
      <th>home_defenceTeamWidthClass</th>
      <th>home_defenceDefenderLineClass</th>
      <th>away_buildUpPlaySpeed</th>
      <th>away_buildUpPlaySpeedClass</th>
      <th>away_buildUpPlayDribblingClass</th>
      <th>away_buildUpPlayPassing</th>
      <th>away_buildUpPlayPassingClass</th>
      <th>away_buildUpPlayPositioningClass</th>
      <th>away_chanceCreationPassing</th>
      <th>away_chanceCreationPassingClass</th>
      <th>away_chanceCreationCrossing</th>
      <th>away_chanceCreationCrossingClass</th>
      <th>away_chanceCreationShooting</th>
      <th>away_chanceCreationShootingClass</th>
      <th>away_chanceCreationPositioningClass</th>
      <th>away_defencePressure</th>
      <th>away_defencePressureClass</th>
      <th>away_defenceAggression</th>
      <th>away_defenceAggressionClass</th>
      <th>away_defenceTeamWidth</th>
      <th>away_defenceTeamWidthClass</th>
      <th>away_defenceDefenderLineClass</th>
      <th>home_player_1_rating</th>
      <th>home_player_2_rating</th>
      <th>home_player_3_rating</th>
      <th>home_player_4_rating</th>
      <th>home_player_5_rating</th>
      <th>home_player_6_rating</th>
      <th>home_player_7_rating</th>
      <th>home_player_8_rating</th>
      <th>home_player_9_rating</th>
      <th>home_player_10_rating</th>
      <th>home_player_11_rating</th>
      <th>away_player_1_rating</th>
      <th>away_player_2_rating</th>
      <th>away_player_3_rating</th>
      <th>away_player_4_rating</th>
      <th>away_player_5_rating</th>
      <th>away_player_6_rating</th>
      <th>away_player_7_rating</th>
      <th>away_player_8_rating</th>
      <th>away_player_9_rating</th>
      <th>away_player_10_rating</th>
      <th>away_player_11_rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>56.333333</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>44.333333</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>55.666667</td>
      <td>Normal</td>
      <td>52.333333</td>
      <td>Normal</td>
      <td>55.833333</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>49.166667</td>
      <td>Medium</td>
      <td>50.666667</td>
      <td>Press</td>
      <td>59.833333</td>
      <td>Normal</td>
      <td>Cover</td>
      <td>46.000000</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>41.500000</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>46.000000</td>
      <td>Normal</td>
      <td>53.500000</td>
      <td>Normal</td>
      <td>53.750000</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>48.250000</td>
      <td>Medium</td>
      <td>49.000000</td>
      <td>Press</td>
      <td>58.750000</td>
      <td>Wide</td>
      <td>Cover</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>55.500000</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>52.666667</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>50.000000</td>
      <td>Normal</td>
      <td>49.333333</td>
      <td>Normal</td>
      <td>41.500000</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>48.666667</td>
      <td>Medium</td>
      <td>56.166667</td>
      <td>Press</td>
      <td>47.833333</td>
      <td>Normal</td>
      <td>Cover</td>
      <td>64.000000</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>53.500000</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>44.000000</td>
      <td>Normal</td>
      <td>47.666667</td>
      <td>Normal</td>
      <td>54.333333</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>48.833333</td>
      <td>Medium</td>
      <td>55.166667</td>
      <td>Press</td>
      <td>55.500000</td>
      <td>Normal</td>
      <td>Cover</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>53.666667</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>44.166667</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>59.000000</td>
      <td>Normal</td>
      <td>60.333333</td>
      <td>Normal</td>
      <td>48.000000</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>60.166667</td>
      <td>Medium</td>
      <td>49.666667</td>
      <td>Press</td>
      <td>64.666667</td>
      <td>Normal</td>
      <td>Cover</td>
      <td>51.333333</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>45.166667</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>63.500000</td>
      <td>Risky</td>
      <td>55.000000</td>
      <td>Normal</td>
      <td>51.333333</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>59.666667</td>
      <td>Medium</td>
      <td>47.666667</td>
      <td>Press</td>
      <td>63.833333</td>
      <td>Normal</td>
      <td>Cover</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>54.166667</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>46.333333</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>44.500000</td>
      <td>Normal</td>
      <td>64.666667</td>
      <td>Normal</td>
      <td>44.166667</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>51.333333</td>
      <td>Medium</td>
      <td>50.000000</td>
      <td>Press</td>
      <td>45.666667</td>
      <td>Normal</td>
      <td>Cover</td>
      <td>51.666667</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>51.666667</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>55.000000</td>
      <td>Normal</td>
      <td>60.666667</td>
      <td>Lots</td>
      <td>46.000000</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>46.000000</td>
      <td>Medium</td>
      <td>45.000000</td>
      <td>Press</td>
      <td>47.000000</td>
      <td>Normal</td>
      <td>Cover</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>59.666667</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>60.333333</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>54.666667</td>
      <td>Normal</td>
      <td>58.833333</td>
      <td>Normal</td>
      <td>61.333333</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>51.500000</td>
      <td>Medium</td>
      <td>57.500000</td>
      <td>Press</td>
      <td>56.500000</td>
      <td>Normal</td>
      <td>Cover</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>

</div>




```python
df.isna().sum()
```




    matchResult                          0
    home_buildUpPlaySpeed              178
    home_buildUpPlaySpeedClass         178
    home_buildUpPlayDribblingClass     178
    home_buildUpPlayPassing            178
                                      ... 
    away_player_7_rating              1235
    away_player_8_rating              1341
    away_player_9_rating              1328
    away_player_10_rating             1441
    away_player_11_rating             1554
    Length: 63, dtype: int64




```python
df.dropna(inplace=True)
```


```python
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>matchResult</th>
      <th>home_buildUpPlaySpeed</th>
      <th>home_buildUpPlaySpeedClass</th>
      <th>home_buildUpPlayDribblingClass</th>
      <th>home_buildUpPlayPassing</th>
      <th>home_buildUpPlayPassingClass</th>
      <th>home_buildUpPlayPositioningClass</th>
      <th>home_chanceCreationPassing</th>
      <th>home_chanceCreationPassingClass</th>
      <th>home_chanceCreationCrossing</th>
      <th>home_chanceCreationCrossingClass</th>
      <th>home_chanceCreationShooting</th>
      <th>home_chanceCreationShootingClass</th>
      <th>home_chanceCreationPositioningClass</th>
      <th>home_defencePressure</th>
      <th>home_defencePressureClass</th>
      <th>home_defenceAggression</th>
      <th>home_defenceAggressionClass</th>
      <th>home_defenceTeamWidth</th>
      <th>home_defenceTeamWidthClass</th>
      <th>home_defenceDefenderLineClass</th>
      <th>away_buildUpPlaySpeed</th>
      <th>away_buildUpPlaySpeedClass</th>
      <th>away_buildUpPlayDribblingClass</th>
      <th>away_buildUpPlayPassing</th>
      <th>away_buildUpPlayPassingClass</th>
      <th>away_buildUpPlayPositioningClass</th>
      <th>away_chanceCreationPassing</th>
      <th>away_chanceCreationPassingClass</th>
      <th>away_chanceCreationCrossing</th>
      <th>away_chanceCreationCrossingClass</th>
      <th>away_chanceCreationShooting</th>
      <th>away_chanceCreationShootingClass</th>
      <th>away_chanceCreationPositioningClass</th>
      <th>away_defencePressure</th>
      <th>away_defencePressureClass</th>
      <th>away_defenceAggression</th>
      <th>away_defenceAggressionClass</th>
      <th>away_defenceTeamWidth</th>
      <th>away_defenceTeamWidthClass</th>
      <th>away_defenceDefenderLineClass</th>
      <th>home_player_1_rating</th>
      <th>home_player_2_rating</th>
      <th>home_player_3_rating</th>
      <th>home_player_4_rating</th>
      <th>home_player_5_rating</th>
      <th>home_player_6_rating</th>
      <th>home_player_7_rating</th>
      <th>home_player_8_rating</th>
      <th>home_player_9_rating</th>
      <th>home_player_10_rating</th>
      <th>home_player_11_rating</th>
      <th>away_player_1_rating</th>
      <th>away_player_2_rating</th>
      <th>away_player_3_rating</th>
      <th>away_player_4_rating</th>
      <th>away_player_5_rating</th>
      <th>away_player_6_rating</th>
      <th>away_player_7_rating</th>
      <th>away_player_8_rating</th>
      <th>away_player_9_rating</th>
      <th>away_player_10_rating</th>
      <th>away_player_11_rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>145</th>
      <td>0</td>
      <td>56.666667</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>47.333333</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>47.5</td>
      <td>Normal</td>
      <td>49.833333</td>
      <td>Normal</td>
      <td>50.333333</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>47.666667</td>
      <td>Medium</td>
      <td>58.833333</td>
      <td>Press</td>
      <td>52.000000</td>
      <td>Normal</td>
      <td>Cover</td>
      <td>56.333333</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>44.333333</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>55.666667</td>
      <td>Normal</td>
      <td>52.333333</td>
      <td>Normal</td>
      <td>55.833333</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>49.166667</td>
      <td>Medium</td>
      <td>50.666667</td>
      <td>Press</td>
      <td>59.833333</td>
      <td>Normal</td>
      <td>Cover</td>
      <td>63.214286</td>
      <td>62.733333</td>
      <td>70.151515</td>
      <td>61.800000</td>
      <td>69.192308</td>
      <td>61.500000</td>
      <td>63.538462</td>
      <td>68.040000</td>
      <td>54.600000</td>
      <td>65.285714</td>
      <td>62.666667</td>
      <td>64.952381</td>
      <td>71.388889</td>
      <td>60.750000</td>
      <td>66.750000</td>
      <td>70.185185</td>
      <td>69.333333</td>
      <td>68.000000</td>
      <td>65.000000</td>
      <td>71.666667</td>
      <td>64.611111</td>
      <td>71.826087</td>
    </tr>
    <tr>
      <th>153</th>
      <td>2</td>
      <td>53.666667</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>44.166667</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>59.0</td>
      <td>Normal</td>
      <td>60.333333</td>
      <td>Normal</td>
      <td>48.000000</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>60.166667</td>
      <td>Medium</td>
      <td>49.666667</td>
      <td>Press</td>
      <td>64.666667</td>
      <td>Normal</td>
      <td>Cover</td>
      <td>49.166667</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>46.500000</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>48.833333</td>
      <td>Normal</td>
      <td>55.833333</td>
      <td>Normal</td>
      <td>47.666667</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>53.666667</td>
      <td>Medium</td>
      <td>53.833333</td>
      <td>Press</td>
      <td>54.666667</td>
      <td>Normal</td>
      <td>Cover</td>
      <td>65.050000</td>
      <td>63.142857</td>
      <td>62.454545</td>
      <td>63.227273</td>
      <td>64.625000</td>
      <td>71.800000</td>
      <td>67.500000</td>
      <td>66.000000</td>
      <td>69.700000</td>
      <td>67.129032</td>
      <td>63.500000</td>
      <td>71.266667</td>
      <td>68.142857</td>
      <td>70.375000</td>
      <td>69.888889</td>
      <td>70.720000</td>
      <td>68.444444</td>
      <td>68.541667</td>
      <td>71.739130</td>
      <td>71.190476</td>
      <td>69.714286</td>
      <td>69.130435</td>
    </tr>
    <tr>
      <th>155</th>
      <td>0</td>
      <td>51.333333</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>45.166667</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>63.5</td>
      <td>Risky</td>
      <td>55.000000</td>
      <td>Normal</td>
      <td>51.333333</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>59.666667</td>
      <td>Medium</td>
      <td>47.666667</td>
      <td>Press</td>
      <td>63.833333</td>
      <td>Normal</td>
      <td>Cover</td>
      <td>55.500000</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>52.666667</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>50.000000</td>
      <td>Normal</td>
      <td>49.333333</td>
      <td>Normal</td>
      <td>41.500000</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>48.666667</td>
      <td>Medium</td>
      <td>56.166667</td>
      <td>Press</td>
      <td>47.833333</td>
      <td>Normal</td>
      <td>Cover</td>
      <td>67.888889</td>
      <td>71.060606</td>
      <td>68.958333</td>
      <td>69.823529</td>
      <td>72.166667</td>
      <td>72.107143</td>
      <td>77.972973</td>
      <td>71.416667</td>
      <td>79.692308</td>
      <td>68.086957</td>
      <td>70.896552</td>
      <td>67.095238</td>
      <td>67.625000</td>
      <td>61.750000</td>
      <td>63.722222</td>
      <td>63.411765</td>
      <td>64.714286</td>
      <td>68.000000</td>
      <td>70.521739</td>
      <td>67.500000</td>
      <td>65.666667</td>
      <td>66.083333</td>
    </tr>
    <tr>
      <th>162</th>
      <td>0</td>
      <td>56.666667</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>47.333333</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>47.5</td>
      <td>Normal</td>
      <td>49.833333</td>
      <td>Normal</td>
      <td>50.333333</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>47.666667</td>
      <td>Medium</td>
      <td>58.833333</td>
      <td>Press</td>
      <td>52.000000</td>
      <td>Normal</td>
      <td>Cover</td>
      <td>51.333333</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>45.166667</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>63.500000</td>
      <td>Risky</td>
      <td>55.000000</td>
      <td>Normal</td>
      <td>51.333333</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>59.666667</td>
      <td>Medium</td>
      <td>47.666667</td>
      <td>Press</td>
      <td>63.833333</td>
      <td>Normal</td>
      <td>Cover</td>
      <td>63.214286</td>
      <td>62.733333</td>
      <td>70.151515</td>
      <td>65.285714</td>
      <td>68.040000</td>
      <td>69.192308</td>
      <td>61.800000</td>
      <td>63.538462</td>
      <td>54.600000</td>
      <td>67.846154</td>
      <td>62.666667</td>
      <td>67.888889</td>
      <td>71.060606</td>
      <td>72.166667</td>
      <td>64.100000</td>
      <td>69.407407</td>
      <td>72.107143</td>
      <td>69.240000</td>
      <td>79.692308</td>
      <td>77.972973</td>
      <td>71.416667</td>
      <td>70.896552</td>
    </tr>
    <tr>
      <th>168</th>
      <td>1</td>
      <td>55.500000</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>52.666667</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>50.0</td>
      <td>Normal</td>
      <td>49.333333</td>
      <td>Normal</td>
      <td>41.500000</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>48.666667</td>
      <td>Medium</td>
      <td>56.166667</td>
      <td>Press</td>
      <td>47.833333</td>
      <td>Normal</td>
      <td>Cover</td>
      <td>65.000000</td>
      <td>Balanced</td>
      <td>Little</td>
      <td>60.000000</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>50.000000</td>
      <td>Normal</td>
      <td>35.000000</td>
      <td>Normal</td>
      <td>40.000000</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>65.000000</td>
      <td>Medium</td>
      <td>70.000000</td>
      <td>Double</td>
      <td>70.000000</td>
      <td>Wide</td>
      <td>Cover</td>
      <td>67.095238</td>
      <td>67.625000</td>
      <td>66.250000</td>
      <td>61.750000</td>
      <td>63.722222</td>
      <td>64.714286</td>
      <td>68.000000</td>
      <td>70.521739</td>
      <td>66.083333</td>
      <td>65.666667</td>
      <td>67.500000</td>
      <td>63.666667</td>
      <td>60.400000</td>
      <td>58.333333</td>
      <td>54.600000</td>
      <td>62.333333</td>
      <td>58.666667</td>
      <td>65.800000</td>
      <td>58.750000</td>
      <td>74.928571</td>
      <td>63.000000</td>
      <td>67.111111</td>
    </tr>
  </tbody>
</table>

</div>



###  모델 재학습하여 평가하기


```python
X_num
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>home_buildUpPlaySpeed</th>
      <th>home_buildUpPlayPassing</th>
      <th>home_chanceCreationPassing</th>
      <th>home_chanceCreationCrossing</th>
      <th>home_chanceCreationShooting</th>
      <th>home_defencePressure</th>
      <th>home_defenceAggression</th>
      <th>home_defenceTeamWidth</th>
      <th>away_buildUpPlaySpeed</th>
      <th>away_buildUpPlayPassing</th>
      <th>away_chanceCreationPassing</th>
      <th>away_chanceCreationCrossing</th>
      <th>away_chanceCreationShooting</th>
      <th>away_defencePressure</th>
      <th>away_defenceAggression</th>
      <th>away_defenceTeamWidth</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>56.333333</td>
      <td>44.333333</td>
      <td>55.666667</td>
      <td>52.333333</td>
      <td>55.833333</td>
      <td>49.166667</td>
      <td>50.666667</td>
      <td>59.833333</td>
      <td>46.000000</td>
      <td>41.500000</td>
      <td>46.000000</td>
      <td>53.500000</td>
      <td>53.750000</td>
      <td>48.250000</td>
      <td>49.000000</td>
      <td>58.750000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>55.500000</td>
      <td>52.666667</td>
      <td>50.000000</td>
      <td>49.333333</td>
      <td>41.500000</td>
      <td>48.666667</td>
      <td>56.166667</td>
      <td>47.833333</td>
      <td>64.000000</td>
      <td>53.500000</td>
      <td>44.000000</td>
      <td>47.666667</td>
      <td>54.333333</td>
      <td>48.833333</td>
      <td>55.166667</td>
      <td>55.500000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>53.666667</td>
      <td>44.166667</td>
      <td>59.000000</td>
      <td>60.333333</td>
      <td>48.000000</td>
      <td>60.166667</td>
      <td>49.666667</td>
      <td>64.666667</td>
      <td>51.333333</td>
      <td>45.166667</td>
      <td>63.500000</td>
      <td>55.000000</td>
      <td>51.333333</td>
      <td>59.666667</td>
      <td>47.666667</td>
      <td>63.833333</td>
    </tr>
    <tr>
      <th>3</th>
      <td>54.166667</td>
      <td>46.333333</td>
      <td>44.500000</td>
      <td>64.666667</td>
      <td>44.166667</td>
      <td>51.333333</td>
      <td>50.000000</td>
      <td>45.666667</td>
      <td>51.666667</td>
      <td>51.666667</td>
      <td>55.000000</td>
      <td>60.666667</td>
      <td>46.000000</td>
      <td>46.000000</td>
      <td>45.000000</td>
      <td>47.000000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>56.666667</td>
      <td>47.333333</td>
      <td>47.500000</td>
      <td>49.833333</td>
      <td>50.333333</td>
      <td>47.666667</td>
      <td>58.833333</td>
      <td>52.000000</td>
      <td>49.166667</td>
      <td>46.500000</td>
      <td>48.833333</td>
      <td>55.833333</td>
      <td>47.666667</td>
      <td>53.666667</td>
      <td>53.833333</td>
      <td>54.666667</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>25972</th>
      <td>56.833333</td>
      <td>50.000000</td>
      <td>48.000000</td>
      <td>55.166667</td>
      <td>53.500000</td>
      <td>48.666667</td>
      <td>46.000000</td>
      <td>55.666667</td>
      <td>56.600000</td>
      <td>35.800000</td>
      <td>63.200000</td>
      <td>36.400000</td>
      <td>59.000000</td>
      <td>45.000000</td>
      <td>42.800000</td>
      <td>51.600000</td>
    </tr>
    <tr>
      <th>25974</th>
      <td>47.600000</td>
      <td>51.800000</td>
      <td>39.800000</td>
      <td>45.200000</td>
      <td>44.400000</td>
      <td>43.800000</td>
      <td>45.600000</td>
      <td>50.800000</td>
      <td>56.600000</td>
      <td>35.800000</td>
      <td>63.200000</td>
      <td>36.400000</td>
      <td>59.000000</td>
      <td>45.000000</td>
      <td>42.800000</td>
      <td>51.600000</td>
    </tr>
    <tr>
      <th>25975</th>
      <td>53.000000</td>
      <td>56.000000</td>
      <td>38.000000</td>
      <td>53.000000</td>
      <td>46.000000</td>
      <td>42.000000</td>
      <td>33.000000</td>
      <td>58.000000</td>
      <td>51.833333</td>
      <td>52.500000</td>
      <td>53.000000</td>
      <td>48.333333</td>
      <td>61.000000</td>
      <td>48.000000</td>
      <td>48.333333</td>
      <td>50.333333</td>
    </tr>
    <tr>
      <th>25976</th>
      <td>49.500000</td>
      <td>53.166667</td>
      <td>53.000000</td>
      <td>58.666667</td>
      <td>50.333333</td>
      <td>37.833333</td>
      <td>46.666667</td>
      <td>51.666667</td>
      <td>54.333333</td>
      <td>44.000000</td>
      <td>60.833333</td>
      <td>52.666667</td>
      <td>54.333333</td>
      <td>42.666667</td>
      <td>43.833333</td>
      <td>50.000000</td>
    </tr>
    <tr>
      <th>25978</th>
      <td>53.833333</td>
      <td>63.000000</td>
      <td>46.000000</td>
      <td>68.500000</td>
      <td>52.000000</td>
      <td>46.500000</td>
      <td>40.000000</td>
      <td>53.500000</td>
      <td>55.000000</td>
      <td>44.833333</td>
      <td>60.833333</td>
      <td>63.833333</td>
      <td>52.500000</td>
      <td>47.666667</td>
      <td>57.500000</td>
      <td>54.500000</td>
    </tr>
  </tbody>
</table>
<p>25629 rows × 16 columns</p>

</div>




```python
X_num = df.drop(['matchResult'] + col_cats,axis=1)
scaler = StandardScaler()
scaler.fit(X_num)
X_scaled = scaler.transform(X_num)
X_scaled = pd.DataFrame(data=X_scaled, index=X_num.index, columns=X_num.columns)

X_cat = pd.get_dummies(df[col_cats], drop_first=True)
X = pd.concat([X_scaled, X_cat], axis=1)
y = df['matchResult']

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=1)
```


```python
model_lr = LogisticRegression(max_iter=10000)
model_lr.fit(X_train, y_train)


pred = model_lr.predict(X_test)
print(classification_report(y_test, pred))
```

                  precision    recall  f1-score   support
    
               0       0.55      0.83      0.66      2945
               1       0.31      0.01      0.02      1587
               2       0.47      0.50      0.49      1842
    
        accuracy                           0.53      6374
       macro avg       0.45      0.44      0.39      6374
    weighted avg       0.47      0.53      0.45      6374


​    


```python
fig = plt.figure(figsize=(15, 5))
plt.plot(X.columns, model_lr.coef_[0])
plt.xticks(rotation=90)
plt.title('What makes Home Team Win?')
plt.grid()
plt.show()
```

![image-center](/assets/images/sc5.png){: .align-center}




```python
fig = plt.figure(figsize=(15, 5))
plt.plot(X.columns, model_lr.coef_[2])
plt.xticks(rotation=90)
plt.title('What makes Away Team Win?')
plt.grid()
plt.show()
```

![image-center](/assets/images/sc6.png){: .align-center}




```python
model_xgb = XGBClassifier()
model_xgb.fit(X_train, y_train)

pred = model_xgb.predict(X_test)
print(classification_report(y_test, pred))

# 데이터 수정 후 모델의 정확성이 올라감
```

                  precision    recall  f1-score   support
    
               0       0.55      0.85      0.66      2945
               1       0.37      0.02      0.03      1587
               2       0.49      0.46      0.48      1842
    
        accuracy                           0.53      6374
       macro avg       0.47      0.44      0.39      6374
    weighted avg       0.49      0.53      0.45      6374


​    


```python
fig = plt.figure(figsize=(10,15))
plt.barh(X.columns,model_xgb.feature_importances_)
#plt.xticks(rotation=90)
plt.grid()
plt.show()
```

![image-center](/assets/images/sc7.png){: .align-center}




```python
print(sum(y_test ==0) / len(y_test)) # 홈팀 승리 확률
print(sum(y_test ==1) / len(y_test)) # 홈팀 패배 확률
print(sum(y_test ==2) / len(y_test)) # 홈팀 무승부 확률
```

    0.4620332601192344
    0.24898023219328522
    0.2889865076874804

